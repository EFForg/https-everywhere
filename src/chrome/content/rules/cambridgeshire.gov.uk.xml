<!--
	Cambridgeshire County Council

	For other UK government coverage, see GOV.UK.xml.


	Nonfunctional hosts in *cambridgeshire.gov.uk:

		- planning ᵈ
		- www.slc ᶠ

	ᵈ Dropped
	ᶠ Handshake fails


	Problematic hosts in *cambridgeshire.gov.uk:

		- ^ ⁵
		- hpac ᵐ
		- pensions ᵐ

	⁵ 500
	ᵐ Mismatched


	Partially covered hosts in *cambridgeshire.gov.uk:

		- hpac *
		- parking **

	* Not all possible redirect patterns observed
	** Test failure for $ <= 403 vs 200 default page


	Insecure cookies are set for these hosts:

		- mft.cambridgeshire.gov.uk
		- netloan.cambridgeshire.gov.uk
		- parking.cambridgeshire.gov.uk
		- www.cambridgeshire.gov.uk
		- .www.cambridgeshire.gov.uk


	Mixed content:

		- css on pensions from fonts.googleapis.com
		- Images on pensions from $self

-->
<ruleset name="Cambridgeshire.gov.uk (partial)">

	<!--	Direct rewrites:
				-->
	<target host="buswaytickets.cambridgeshire.gov.uk" />
	<target host="ems.cambridgeshire.gov.uk" />
	<target host="mft.cambridgeshire.gov.uk" />
	<target host="netloan.cambridgeshire.gov.uk" />
	<target host="parking.cambridgeshire.gov.uk" />
	<target host="www.cambridgeshire.gov.uk" />

	<!--	Complications:
				-->
	<target host="cambridgeshire.gov.uk" />
	<target host="hpac.cambridgeshire.gov.uk" />
	<target host="pensions.cambridgeshire.gov.uk" />

		<!--	Other patterns not covered.

			See below respective rules for negative cases.
									-->
		<exclusion pattern="^http://hpac\.cambridgeshire\.gov\.uk/(?!/*(?:$|\?|HPAC(?:$|[?/])))" />

			<!--	+ve:
					-->
			<test url="http://hpac.cambridgeshire.gov.uk/Default.aspx" />
			<test url="http://hpac.cambridgeshire.gov.uk/default.aspx" />
			<test url="http://hpac.cambridgeshire.gov.uk/favicon.ico" />
			<test url="http://hpac.cambridgeshire.gov.uk/home" />
			<test url="http://hpac.cambridgeshire.gov.uk/index.htm" />
			<test url="http://hpac.cambridgeshire.gov.uk/index.html" />
			<test url="http://hpac.cambridgeshire.gov.uk/index.php" />
			<test url="http://hpac.cambridgeshire.gov.uk/index.xhtml" />

		<!--	403 vs 200 default page
			=> fetch test would fail
						-->
		<exclusion pattern="^http://parking\.cambridgeshire\.gov\.uk/$" />

		<!--	Sets cookie without Secure:
							-->
		<test url="http://parking.cambridgeshire.gov.uk/live-3sc-user/" />


	<!--	Not secured by server:
					-->
	<!--securecookie host="^mft\.cambridgeshire\.gov\.uk$" name="^(?:DMZCookieTest|DesignModeTest|JavascriptTest|LongTermCookieExpireDate|MIMZLang|NoWiz|WizardVersions|siLockLongTermInstID)$" /-->
	<!--securecookie host="^(?:netloan|parking|www)\.cambridgeshire\.gov\.uk$" name="^ASP\.NET_SessionId$" /-->
	<!--securecookie host="^\.www\.cambridgeshire\.gov\.uk$" name="^TestCookie$" /-->

	<securecookie host="^\.www\." name="." />
	<securecookie host="^(?!hpac\.)\w" name="." />


	<rule from="^http://cambridgeshire\.gov\.uk/"
		to="https://www.cambridgeshire.gov.uk/" />

	<rule from="^http://hpac\.cambridgeshire\.gov\.uk/+$"
		to="https://www.hpac.nhs.uk/HPAC/HPACIndex.jsp?sitename=hpac.cambridgeshire.gov.uk" />

		<test url="http://hpac.cambridgeshire.gov.uk//" />

	<rule from="^http://hpac\.cambridgeshire\.gov\.uk/+\?(.*)"
		to="https://www.hpac.nhs.uk/HPAC/HPACIndex.jsp?$1&amp;sitename=hpac.cambridgeshire.gov.uk" />

		<test url="http://hpac.cambridgeshire.gov.uk/?dsn=hpcambridge" />
		<test url="http://hpac.cambridgeshire.gov.uk/?referrer=" />
		<test url="http://hpac.cambridgeshire.gov.uk/?subjectId=0" />

	<rule from="^http://hpac\.cambridgeshire\.gov\.uk/+HPAC(?=$|(/[^?]*)$)"
		to="https://www.hpac.nhs.uk/HPAC$1?sitename=hpac.cambridgeshire.gov.uk" />

		<test url="http://hpac.cambridgeshire.gov.uk/HPAC" />
		<test url="http://hpac.cambridgeshire.gov.uk/HPAC/About.jsp" />
		<test url="http://hpac.cambridgeshire.gov.uk/HPAC/Cookies.jsp" />
		<test url="http://hpac.cambridgeshire.gov.uk/HPAC/Index.jsp" />

	<rule from="^http://hpac\.cambridgeshire\.gov\.uk/+HPAC(/(?!.*sitename=hpac\.cambridgeshire\.gov\.uk).*)"
		to="https://www.hpac.nhs.uk/HPAC$1&amp;sitename=hpac.cambridgeshire.gov.uk" />

		<test url="http://hpac.cambridgeshire.gov.uk/HPAC/ClickCounter?action=o&amp;resourceId=15438&amp;url=%27https%3A%2F%2Fwww.blf.org.uk%2FPage%2FLooking-after-someone-with-lung-disease%27" />
		<test url="http://hpac.cambridgeshire.gov.uk/HPAC/ClickCounter?action=o&amp;resourceId=15631&amp;url=%27http%3A%2F%2Fwww.bookstart.org.uk%2Fbooks%2F%27" />
		<test url="http://hpac.cambridgeshire.gov.uk/HPAC/ClickCounter?action=o&amp;resourceId=9475&amp;url=%27http%3A%2F%2Fbikehub.co.uk%2F%27" />
		<test url="http://hpac.cambridgeshire.gov.uk/HPAC/MoreDetails.jsp?id=15827&amp;dsn=hpcambridge&amp;subjectId=0&amp;referrer=https://hpac.cambridgeshire.gov.uk/HPAC/HPACIndex.jsp" />

	<rule from="^http://hpac\.cambridgeshire\.gov\.uk/"
		to="https://www.hpac.nhs.uk/" />

		<test url="http://hpac.cambridgeshire.gov.uk/HPAC/ClickCounter?action=o&amp;resourceId=15704&amp;url=%27http%3A%2F%2Fcare-network.org.uk%2F%27&amp;sitename=hpac.cambridgeshire.gov.uk" />

	<!--	s? for protocol-relative inclusion at destination:
								-->
	<rule from="^https?://pensions\.cambridgeshire\.gov\.uk/"
		to="https://pensions.northamptonshire.gov.uk/" />

		<!--	Specifically:
					-->
		<test url="http://pensions.cambridgeshire.gov.uk/wp-content/uploads/2012/10/header4.gif" />

	<rule from="^http:"
		to="https:" />

</ruleset>
