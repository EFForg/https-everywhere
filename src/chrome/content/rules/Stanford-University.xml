<!--
	Stanford University

	For problematic rules, see Stanford-University-problematic.xml.


	Other Stanford University rulesets:

		- Hoover_Institution.xml


	store-0ef21.mybigcommerce


	Nonfunctional subdomains:

		- assu			($ redirects to http; at least some paths 404)
		- bma ²
		- bondholder-information(redirects to http)
		- campusmap		(shows hannahousetours, mismatched, CN: hannahousetours.stanford.edu)
		- campus-map ²
		- cantorcollections **
		- cees ⁵
		- coursematerials ⁶
		- cpudb **
		- create ⁶
		- edf ⁷
		- elections		("not yet configured")
		- emergency **
		- exploredegrees **
		- facts ³
		- fac-web3 ²
		- fah-web		(cert valid; 302s to http)
		- fairuse
		- humsci **
		- liberationtechnology **
		- lytics **
		- oli ³
		- online ³
		- ppl **
		- rph ³
		- scpdweb ⁶

		- dune.scs **
		- ori.scs **
		- www.scs **

		- sedcl **
		- babar-hn.slac		(rx_record_too_long)
		- home.slac
		- srp			(reused serial)
		- sse			("not yet configured")
		- sselabs		(cert: assu-web.stanford.edu; "not yet configured")
		- stanford-online	(times out)
		- startx		("not yet configured")
		- store			($ redirects to http; at least some paths 404)
		- theory		(shows Fedora test page, self-signed)
		- transportation ⁹
		- vis			(Shows graphics)
		- www-sul ᵇ

	² Shows hannahousetours
	** Refused
	³ Redirects to http
	⁵ Shows pangea
	⁶ Dropped
	⁷ Shows cepa
	⁹ Plaintext reply
	ᵇ Shows swp


	Problematic subdomains:

		- ^			(cert only matches *.stanford.edu)
		- askjane		(mismatched, CN: studentaffairs.stanford.edu)
		- arts ³
		- biosciences ⁴
		- brannerlibrary ⁵
		- bgm *
		- cmgm3			(Insecure renegotiation)
		- cme ⁴
		- computing **
		- csl			(Expired, self-signed)
		- dor ⁸
		- email **
		- ess **
		- fingate **
		- gse ⁵
		- healthlibrary ⁴
		- hrg ⁴
		- itmetrics **
		- itwinterclosure **
		- maps *
		- medblogs ³
		- medicalgiving		(iModules)
		- netreg ⁹
		- postdocs ⁴
		- scopeblog ³
		- search **
		- security ᵃ
		- slac			(cert only matches www.slac)
		- smysp ⁴
		- soe			(refused)
		- stanfordmedicine ⁴
		- studentservicescenter **
		- thestanfordchallenge	(works, mismatched, CN: ood-web1.stanford.edu)
		- trachea ⁴
		- vsc ⁴
		- winkleby ⁴
		- www-cs-students	(mismatched, CN: xenon.stanford.edu)


	³ Mixed css
	⁴ Mismatched, CN: med.stanford.edu
	⁵ 403
	* Works, mismatched, CN: lbre.stanford.edu
	** Redirects to http
	⁸ Mismatched, CN: doresearch.stanford.edu
	⁹ Shows rescomp
	ᵃ Refused


	Partially covered subdomains:

		- plato *
		- arts **
		- medblogs **
		- scpd ³
		- scopeblog **
		- soe	(→ engineering, [^/?]+ 404s)
		- www-cs-students ²	(→ xenon)
		- xenon ²

	* Some pages redirect to http, others 404
	** Avoiding false/broken MCB
	³ Some pages redirect to http
	² Personal dirs 404


	Fully covered subdomains:

		- (www.)		(^ → www)
		- accessories
		- accounts
		- acomp
		- acp
		- adminguide
		- admission
		- ai
		- alumni
		- alumni-gsb
		- anderson
		- annualreport
		- answers
		- apps
		- art
		- artsinstitute
		- askjane
		- as
		- asdashboard
		- assu-web
		- asweb
		- atxpo
		- axess
		- benefits
		- bewell
		- beyondthebubble
		- brannerlibrary	(→ library)
		- businessaffairs
		- cancer
		- cap
		- ccrma
		- computing	(→ itservices)
		- crowd
		- crypto
		- (www.)cs	( www → ^)
		- cepa
		- classx
		- cmgm3
		- ctr
		- cyberlaw
		- dashboard
		- dataclass
		- docxpress
		- dor		(→ doresearch)
		- doresearch
		- earth
		- earthsci
		- ebola
		- ed
		- ee
		- ee-www
		- ehsappprd1
		- engineering
		- epgy
		- eprotocol
		- email		(→ itservices)
		- ess		(→ itservices)
		- events
		- explorecourses
		- facultyaffairs
		- facultyaffairs-humsci
		- facultydevelopment
		- facultyhandbook
		- fah
		- fingate
		- folding
		- forum
		- founders
		- gadgets
		- giving
		- givinghistory
		- givingtostanford
		- graphics
		- (www.)gsb
		- alumni.gsb
		- gse			(→ ed)
		- gus-humsci
		- hannahousetours
		- harass
		- helpcenter
		- helpsu
		- honorrolls
		- hsdo
		- humansubjects
		- icenter
		- idp
		- italerts
		- itmetrics		(→ dashboard)
		- itservices
		- itunes
		- itwinterclosure	(→ itservices)
		- janestanford
		- labanimals
		- lane
		- lane-preprod
		- (www.)law
		- blogs.law
		- cch.law
		- lbre
		- lbre-apps
		- lbrehr
		- lbre-internal
		- lib
		- library
		- lists
		- live
		- mailman
		- majors
		- makeagift
		- makeapledge
		- makeapledgepayment
		- mast
		- math
		- maven
		- (www.)med
		- medmeeting
		- medwiki
		- monitoring
		- museum
		- music
		- mvideos
		- mygsb
		- netreg	(→ rescomp
		- news
		- notalone
		- npl
		- ogc
		- ohs
		- ohsx
		- oia
		- oncore
		- opacs
		- opacsprd
		- openflow
		- openknowledge
		- orderit
		- osep
		- owamail
		- pangea
		- parents
		- parentsweekend
		- pgnet
		- police
		- porterdrive
		- precollegiate
		- president
		- profiles
		- provost
		- publicaffairs
		- refunds
		- registrar
		- remedyweb
		- rescomp
		- researchcompliance
		- roadside-mba
		- safety
		- axess.sahr
		- sciencecircle
		- scienceconference
		- scro
		- sdlf
		- search
		- securecomputing
		- security		(→ web)
		- sera
		- sheg
		- siepr
		- signalblog
		- sites

		- slac subdomains:

			- (www.)	(^ → www)
			- bbr-wiki
			- news
			- oraweb
			- webauth1
			- www2
			- www6
			- www-conf
			- www-group
			- www-public

		- spcs
		- stanfordcareers
		- stanfordevents
		- stanfordmedicine	(→ med)
		- stanfordwho
		- stanfordyou
		- studentaffairs
		- studentservicescenter
		- summercollege
		- summercollegeacademy
		- summerhumanities
		- summerinstitutes
		- sunetid
		- suse
		- swp
		- teachingcommons
		- tickets
		- titleix
		- trachea		(→ med)
		- ucomm
		- uhr
		- uit
		- undergrad
		- visit
		- vpol
		- waivers
		- wasc
		- web
		- weblogin
		- worklife
		- www-aws
		- www-ee
		- youthorchestra


	Observed cookie domains:

		- . *
		- .answers
		- .cs
		- doresearch *
		- .engineering
		- .itservices
		- .lbre
		- .oit ²
		- .stanfordcareers *

	* Not secured by us <= accounting for possible use on unsecured domains
	² Secured by server


	Mixed content:

		- iframe on admission from www.youtube.com *

		- css, on:

			- admission from $self *
			- admission from www *
			- biosciences from $self *
			- admission, giving, precollegiate, stanfordcareers from fonts.googleapis.com *
			- scopeblog from $self *
			- scopeblog from med *

		- Images, on:

			- admission from $self *
			- (www.)med from med *

		- Bugs, on:

			- events from www.facebook.com *

	* Secured by us

-->
<ruleset name="Stanford.edu (partial)">

	<target host="stanford.edu" />
	<target host="*.stanford.edu" />
		<!--
			Avoid false/broken MCB:
						-->
		<exclusion pattern="^http://(?:arts|medblogs|scopeblog)\.stanford\.edu/+(?!wp-content/|wp-includes/)" />
		<exclusion pattern="^http://admission\.stanford\.edu/+(?!assets/|css/|images/|img/|libs/)" />
		<exclusion pattern="^http://plato\.stanford\.edu/+(?!css/|symbols/)" />
		<!--
			Redirect to http:
						-->
		<!--exclusion pattern="^http://scpd\.stanford\.edu/home$" /-->
		<!--
			Exceptions:
					-->
		<exclusion pattern="^http://scpd\.stanford\.edu/+(?!favicon\.ico|public/|restricted/|upload/)" />
		<!--
			Personal dirs 404
					-->
		<exclusion pattern="^http://(?:www-cs-students|xenon)\.stanford\.edu/+~" />

        <!-- Exclusion for Flashproxy: https://trac.torproject.org/projects/tor/wiki/FlashProxyFAQ -->
        <exclusion pattern="^http://crypto\.stanford\.edu/flashproxy/embed\.html" />

	<!--securecookie host="^(\.cs|\.engineering)?\.stanford\.edu$" name=".+" /-->
	<!--
		Not secured by server:
					-->
	<!--securecookie host="^\.stanford\.edu$" name="^(COOKIE_DEVICE_CLASS|SS_MID|pgn_new_browser|pgn_user2)$" /-->
	<!--securecookie host="^(alumni|alumni-gsb|givinghistory|honorrolls|makeagift|makeapledge|makeapledgepayment|pgnet)?\.stanford\.edu$" name="^TS[\da-f]{8}$" /-->
	<!--securecookie host="^doresearch\.stanford\.edu$" name="^(SimpleSAMLSessionID|simplesamlphp_auth_returnto)$" /-->
	<!--securecookie host="^(\.answers|\.bewell|\.bgm|\.engineering|\.facultyaffairs|\.facultyaffairs-humsci|\.hsdo|\.law|\.lbre|\.lib|\.maps|\.ohsx|\.openknowledge|\.porterdrive|\.stanfordcareers)?\.stanford\.edu$" name="^SESS[\da-f]{32}$" /-->
	<!--securecookie host="^epgy\.stanford\.edu$" name="^[\da-f]{32}$" /-->
	<!--securecookie host="^(hannahousetours|anderson|lane)\.stanford\.edu$" name="^PHPSESSID$" /-->
	<!--securecookie host="^(cap|explorecourses|lane|med|profiles|scpd)\.stanford\.edu$" name="^JSESSIONID$" /-->
	<!--securecookie host="^blogs\.law\.stanford\.edu$" name="^bid$" /-->
	<!--securecookie host="^library\.stanford\.edu$" name="^BIGipServer~SULAIR~libweb_https$" /-->
	<!--securecookie host="^mvideos\.stanford\.edu$" name="^(ASP\.NET_SessionId|\.ASPXAUTH)$" /-->

	<securecookie host="^(?:adminguide|alumni|alumni-gsb|anderson|\.answers|\.bewell|cap|ehsappprd1|epgy|explorecourses|\.facultyaffairs|givinghistory|hannahousetours|\.itservices|lane|(?:blogs)?\.law|\.lbre|library|makeagift|makeapledge|maven|cap|mvideos|openflow|parents|pgnet|\.porterdrive|profiles|\.sdlf|\.siepr|(?:\.news|www6)\.slac\|\.stanfordcareers|stanfordwho|weblogin|webauth1).stanford\.edu$" name=".+" />

	<rule from="^http://(?:www\.)?(slac\.)?stanford\.edu/"
		to="https://www.$1stanford.edu/" />

	<rule from="^http://(accessories|accounts|acomp|acp|adminguide|admission|ai|alumni|alumni-gsb|anderson|annualreport|answers|apps|arts?|artsinstitute|as|asdashboard|assu-web|asweb|atxpo|axess|benefits|bewell|beyondthebubble|businessaffairs|cancer|cap|ccrma|cepa|classx|cmgm3|crowd|crypto|ctr|cyberlaw|dashboard|dataclass|docxpress|doresearch|earth|earthsci|ebola|ed|ee|ee-www|ehsappprd1|engineering|epgy|eprotocol|events|explorecourses|faculty(?:affairs|affairs-humsci|development|handbook)|fah|folding|forum|founders|gadgets|giving(?:history|tostanford)?|graphics|(?:alumni\.|www\.)?gsb|gus-humsci|hannahousetours|harass|helpcenter|helpsu|honorrolls|hsdo|humansubjects|icenter|idp|italerts|itservices|itunes|janestanford|labanimals|lane|lane-preprod|(?:blogs\.|cch\.|www\.)?law|lbre(?:-apps|hr|-internal)?|lib|library|lists|live|mailman|majors|makeagift|makeapledge|makeapledgepayment|mast|math|maven|(?:www\.)?med|medblogs|medmeeting|medwiki|monitoring|museum|music|mvideos|mygsb|news|notalone|npl|ogc|ohsx?|oia|oncore|opacs|opacsprd|openflow|openknowledge|orderit|osep|owamail|pangea|parents|parentsweekend|pgnet|police|porterdrive|precollegiate|president|profiles|provost|publicaffairs|refunds|registrar|remedyweb|rescomp|researchcompliance|roadside-mba|safety|axess\.sahr|sciencecircle|scienceconference|scopeblog|scro|scpd|sdlf|securecomputing|sera|sheg|siepr|signalblog|sites|(?:bbr-wiki|news|oraweb|plato|webauth1|www[26]|www-conf|www-group|www-public)\.slac|spcs|stanford(?:careers|events|who|you)|studentaffairs|summer(?:college|collegeacademy|humanities|institutes)|sunetid|suse|swp|teachingcommons|tickets|titleix|ucomm|uhr|uit|undergrad|visit|vpol|waivers|wasc|web|weblogin|worklife|www-aws|www-ee|xenon|youthorchestra)\.stanford\.edu/"
		to="https://$1.stanford.edu/" />

	<!--	Redirects like so:
					-->
	<rule from="^http://brannerlibrary\.stanford\.edu/+"
		to="https://library.stanford.edu/branner/" />

	<rule from="^http://(?:www\.)?cs\.stanford\.edu/"
		to="https://cs.stanford.edu/" />

	<rule from="^http://askjane\.stanford\.edu/(?:.*)"
		to="https://studentaffairs.stanford.edu/askjane" />

	<!--	Redirects like so:
					-->
	<rule from="^http://computing\.stanford\.edu/+"
		to="https://itservices.stanford.edu/service/computing" />

	<!--	Redirects like so:
					-->
	<rule from="^http://dor\.stanford\.edu/"
		to="https://doresearch.stanford.edu/" />

	<!--	Redirects like so:
					-->
	<rule from="^http://email\.stanford\.edu/+"
		to="https://itservices.stanford.edu/service/emailcalendar/email/" />

	<!--	Redirects like so:
					-->
	<rule from="^http://ess\.stanford\.edu/+"
		to="https://itservices.stanford.edu/service/ess/" />

	<rule from="^http://fingate\.stanford\.edu/"
		to="https://www.stanford.edu/group/fms/fingate/" />

	<!--	Redirects like so:
					-->
	<rule from="^http://gse\.stanford\.edu/+"
		to="https://ed.stanford.edu/" />

	<!--	Redirects like so:
					-->
	<rule from="^http://itmetrics\.stanford\.edu/+"
		to="https://dashboard.stanford.edu/" />

	<!--	Redirects like so:
					-->
	<rule from="^http://itwinterclosure\.stanford\.edu/+"
		to="https://itservices.stanford.edu/organization/winterclosure" />

	<!--	Redirects like so:
					-->
	<rule from="^http://netreg\.stanford\.edu/+"
		to="https://rescomp.stanford.edu/iprequest/" />

	<rule from="^http://search\.stanford\.edu/"
		to="https://www.stanford.edu/search/" />

	<!--	Redirects like so:
					-->
	<rule from="^http://security\.stanford\.edu/"
		to="https://web.stanford.edu/group/security/" />

	<rule from="^http://soe\.stanford\.edu/+(?=\?.*)?$"
		to="https://engineering.stanford.edu/" />

	<!--	Redirect drops path and args:
						-->
	<rule from="^http://stanfordmedicine\.stanford\.edu/.*"
		to="https://med.stanford.edu/" />

	<rule from="^http://studentservicescenter\.stanford\.edu/"
		to="https://www.stanford.edu/group/studentservicescenter/" />

	<!--	Redirect drops args:
					-->
	<rule from="^http://trachea\.stanford\.edu/+(?:$|\?.*)"
		to="https://med.stanford.edu/ohns/education/residency/portal/" />

	<rule from="^http://trachea\.stanford\.edu/"
		to="https://med.stanford.edu/" />

	<rule from="^http://www-cs-students\.stanford\.edu/"
		to="https://xenon.stanford.edu/" />

</ruleset>
