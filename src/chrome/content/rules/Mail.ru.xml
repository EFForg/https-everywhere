<!--
	Other Mail.ru rulesets:

		- DatacloudMail.ru.xml
		- ICQ.com.xml
		- Imgs_Mail.ru.xml
		- List.ru.xml
		- Mradx.net.xml
		- Ok.ru.xml
		- TimeZero.ru.xml


	Nonfunctional hosts in *mail.ru:

		- forum.games.mail.ru ²

		- m.agent ²
		- rfr.agent ³
		- internet ⁵

		- love ⁴
		- m.love ᵃ
		- wap.love ²

		- mailblog ²
		- mra ³
		- click.my ⁷
		- otvet ⁴
		- pogoda ²
		- r2 ¹

		- showbiz.mail.ru ³

		- team ⁴
		- d4.c8.b0.a2.top

		- torg ⁴
		- chelyabinsk.torg ⁴
		- img.torg ⁴
		- m.torg ⁴

		- lotro ²
		- webmaster ¹
		- xhtml.wap ²

	ᵃ Shows another domain
	¹ Dropped
	² Refused
	³ Plaintext reply
	⁴ Redirects to http
	⁵ 403
	⁷ 400


	Problematic hosts in *mail.ru:

		- s1.amigo ¹
		- blogs ²
		- cdn.connect ¹
		- w2.dwar	Mixed css
		- content.foto ¹
		- m.go ¹
		- imgs2 ³
		- m.my ¹
		- stat.my ¹
		- \w\d.\w\d.\w\d.\w\d.top ¹
		- img.pre.realty ¹
		- wap ⁴

	¹ Mismatched
	² Shows another domain
	³ 403
	⁴ Refused


	Partially covered hosts in *mail.ru:

		- go *

	* Some pages redirect to http


	Wildcards covered:

		- avt-\d+.foto:

			- [1-9]
			- [12]\d
			- 30

		- cdn\d+.my:

			- 41

		- filed\d+-\d+.my

		- content-\d+.foto.my:

			- [3468]
			- 1[048]
			- 2[267-9]
			- 30

		- (\w\d.){4}top		(→ top-fwz1.mail.ru)


	r2: Dropped over http


	These altnames don't exist:

		- mobfarm.mail.ru
		- wartune.mail.ru


	Insecure cookies are set for these domains and hosts:

		- .mail.ru
		- 1link.mail.ru
		- .agent.mail.ru
		- .bb.mail.ru
		- cfire.mail.ru
		- .dn.mail.ru
		- .games.mail.ru
		- hi-tech.mail.ru
		- it.mail.ru
		- .jd.mail.ru
		- parapa.mail.ru
		- pw.mail.ru
		- realty.mail.ru
		- .realty.mail.ru
		- pro.realty.mail.ru
		- .tv.mail.ru


	Mixed content:

		- css on dwar from odnoklassniki.ru

		- Images, on:

			- blogs from rs.mail.ru *
			- dobro, corp from $self *
			- m.games from games *
			- m.games from stat.my *
			- m.games from my1.imgsmail.com *
			- s1.jugger from s1.jugger.ru *
			- rabota from hh.ru *
			- tz from www.timezero.ru *

		- favicon on m.games from games *

		- Bugs, on:

			- blogs from stat.my *
			- sales from rss
			- maps, sales from www.tns-counter.ru *

	* Secured by us, see https://www.paulirish.com/2010/the-protocol-relative-url/

-->
<ruleset name="Mail.ru (partial)">

	<!--	as-is rewrites:
				-->
	<target host="mail.ru" />
	<target host="1l-go.mail.ru" />
	<target host="1l-view.mail.ru" />
	<target host="1link.mail.ru" />
	<target host="portal.1link.mail.ru" />
	<target host="3k.mail.ru" />
	<target host="aa.mail.ru" />
	<target host="ad.mail.ru" />
	<target host="afisha.mail.ru" />
	<target host="pic.afisha.mail.ru" />
	<target host="touch.afisha.mail.ru" />
	<target host="agent.mail.ru" />
	<target host="allods.mail.ru" />
	<target host="amigo.mail.ru" />
	<target host="auto.mail.ru" />
	<target host="touch.auto.mail.ru" />
	<target host="bb.mail.ru" />
	<target host="bs.mail.ru" />
	<target host="biz.mail.ru" />
	<target host="c.mail.ru" />
	<target host="promo.calendar.mail.ru" />
	<target host="cars.mail.ru" />
	<target host="cfire.mail.ru" />
	<target host="cloud.mail.ru" />
	<target host="connect.mail.ru" />
	<target host="corp.mail.ru" />
	<target host="cp-filin.mail.ru" />
	<target host="static.dl.mail.ru" />
	<target host="deti.mail.ru" />
	<target host="touch.deti.mail.ru" />
	<target host="touch.forum.deti.mail.ru" />
	<target host="dn.mail.ru" />
	<target host="dobro.mail.ru" />
	<target host="dwar.mail.ru" />
	<!--target host="d2.dwar.mail.ru" /-->
	<target host="filin.mail.ru" />
	<target host="avt.foto.mail.ru" />
	<target host="*.foto.mail.ru" />
	<target host="games.mail.ru" />

	<target host="bonus.games.mail.ru" />
	<target host="m.games.mail.ru" />

	<target host="go.mail.ru" />
	<target host="health.mail.ru" />
	<target host="help.mail.ru" />
	<target host="hi-tech.mail.ru" />
	<target host="m.hi-tech.mail.ru" />
	<target host="horo.mail.ru" />
	<target host="touch.horo.mail.ru" />
	<target host="img.mail.ru" />
	<target host="it.mail.ru" />
	<target host="www.it.mail.ru" />
	<target host="jd.mail.ru" />
	<target host="jugger.mail.ru" />
	<target host="s1.jugger.mail.ru" />
	<target host="lady.mail.ru" />
	<target host="images.lady.mail.ru" />
	<target host="bar.love.mail.ru" />
	<target host="m.mail.ru" />
	<target host="maps.mail.ru" />
	<target host="minigames.mail.ru" />
	<target host="money.mail.ru" />
	<target host="m.money.mail.ru" />
	<target host="my.mail.ru" />

	<target host="*.my.mail.ru" />
	<target host="content.foto.my.mail.ru" />
	<!--target host="*.foto.my.mail.ru" /-->
	<target host="stat.my.mail.ru" />
	<target host="videoapi.my.mail.ru" />

	<target host="news.mail.ru" />

	<target host="m.news.mail.ru" />
	<target host="pic.news.mail.ru" />
	<target host="retina.news.mail.ru" />
	<target host="touch.news.mail.ru" />

	<target host="opensource.mail.ru" />
	<target host="touch.otvet.mail.ru" />
	<target host="parapa.mail.ru" />
	<target host="pirates.mail.ru" />
	<target host="pw.mail.ru" />
	<target host="rabota.mail.ru" />
	<target host="r.mail.ru" />
	<target host="r3.mail.ru" />
	<target host="realty.mail.ru" />
	<target host="img.realty.mail.ru" />
	<target host="pro.realty.mail.ru" />
	<target host="riot.mail.ru" />
	<target host="rs.mail.ru" />
	<target host="sales.mail.ru" />
	<target host="security.mail.ru" />
	<target host="sf.mail.ru" />
	<target host="socdwar.mail.ru" />
	<target host="sport.mail.ru" />
	<target host="status.mail.ru" />
	<target host="swa.mail.ru" />
	<target host="tanki.mail.ru" />
	<target host="tanks.mail.ru" />
	<target host="target.mail.ru" />
	<target host="tel.mail.ru" />
	<target host="top.mail.ru" />
	<target host="top-fwz1.mail.ru" />
	<target host="tv.mail.ru" />
	<target host="my.tv.mail.ru" />
	<target host="wap.tv.mail.ru" />
	<target host="tz.mail.ru" />
	<target host="wf.mail.ru" />
	<target host="wot.mail.ru" />
	<target host="why.mail.ru" />
	<target host="www.mail.ru" />

	<!--	Special cases:
				-->
	<target host="blogs.mail.ru" />
	<target host="cdn.connect.mail.ru" />
	<target host="content.foto.mail.ru" />
	<target host="img.pre.realty.mail.ru" />
	<target host="*.top.mail.ru" />
	<target host="wap.mail.ru" />

		<!-- Flash-based players fails load ads if detect redirects. It can issue lower video quality on videohostings like on rutube.ru -->
		<exclusion pattern="^http://ad\.mail\.ru/crossdomain.xml" />

			<!--	+ve:
					-->
			<test url="http://ad.mail.ru/crossdomain.xml" />

		<!--	Redirect to http:
						-->
		<!--exclusion pattern="^http://otvet\.mail\.ru/($|auth$|favicon\.ico|favicon-(16|32|64)\.png|images/|question/\d+$|s\.css)" /-->
		<!--exclusion pattern="^http://team\.mail\.ru/($|\?mcsf_action=main_css|favicon\.ico|wp-content/)" /-->
		<!--exclusion pattern="^http://(torg|m\.torg|wap)\.mail\.ru/($|favicon\.ico)" /-->

		<!--	Formerly redirected to http:
							-->
		<!--exclusion pattern="^http://games\.mail\.ru/($|\?from=navi$|support/tanks/$)" /-->
		<!--
			Exceptions:
					-->
		<!--exclusion pattern="^http://games\.mail\.ru/+(?!css/|favicon\.ico|fonts/|img/|pic/|pre_big2?_crop/|r/)" /-->

			<!--	+ve:
					-->
			<test url="http://games.mail.ru/feedback/" />
			<test url="http://games.mail.ru/gamecenter/download/" />
			<test url="http://games.mail.ru/pc/" />
			<test url="http://games.mail.ru/pc/video/" />
			<test url="http://games.mail.ru/play/client/" />
			<test url="http://games.mail.ru/play/new/" />
			<test url="http://games.mail.ru/play/social/" />
			<test url="http://games.mail.ru/profile/" />
			<test url="http://games.mail.ru/support/" />
			<test url="http://games.mail.ru/support/tz/" />

			<!--	-ve:
					-->
			<test url="http://games.mail.ru/css/new_design/main.css" />
			<test url="http://games.mail.ru/favicon.ico" />
			<test url="http://games.mail.ru/img/18.png" />

		<!--	Redirect to http:
						-->
		<!--exclusion pattern="^http://go\.mail\.ru/($|\?module_result=)" /-->
		<!--
			Exceptions:
					-->
		<exclusion pattern="^http://go\.mail\.ru/(?!/*(?:favicon\.ico|static/))" />

			<!--	+ve:
					-->
			<test url="http://go.mail.ru/blog/" />
			<test url="http://go.mail.ru/news" />
			<test url="http://go.mail.ru/realtime" />
			<test url="http://go.mail.ru/search" />

			<!--	-ve:
					-->
			<test url="http://go.mail.ru/static/web/img/opera_bookmark/sd_search_img.png" />

		<test url="http://avt-1.foto.mail.ru/" />
		<test url="http://avt-10.foto.mail.ru/" />
		<test url="http://avt-20.foto.mail.ru/" />
		<test url="http://avt-30.foto.mail.ru/" />
		<test url="http://cdn41.my.mail.ru/" />
		<test url="http://content-1.foto.my.mail.ru/" />
		<test url="http://content-10.foto.my.mail.ru/" />
		<test url="http://content-20.foto.my.mail.ru/" />
		<test url="http://content-30.foto.my.mail.ru/" />


	<!--	Not secured by server:
					-->
	<!--securecookie host="^\.mail\.ru$" name="^(FTID|VID|c|i|mc2|mrcu|p|searchuid)$" /-->
	<!--securecookie host="^1link\.mail\.ru$" name="^c_\d+_\d+$" /-->
	<!--securecookie host="^\.agent\.mail\.ru$" name="^agent_family$" /-->
	<!--securecookie host="^allods\.mail\.ru$" name="^(?:bblastactivity|bblastvisit|bbsessionhash|no_splash|usecache)$" /-->
	<!--securecookie host="^(?:cfire|parapa)\.mail\.ru$" name="^PHPSESSID$" /-->
	<!--securecookie host="^\.(?:bb|dn|jd)\.mail\.ru$" name="^(?:___mrtc|SESS[\da-f]{32})$" /-->
	<!--securecookie host="^\.games\.mail\.ru$" name="^(?:gmab|targeting)$" /-->
	<!--securecookie host="^it\.mail\.ru$" name="^csrftoken$" /-->
	<!--securecookie host="^hi-tech\.mail\.ru$" name="^last_visits$" /-->
	<!--securecookie host="^(pro\.)?realty\.mail\.ru$" name="^x_user_id$" /-->
	<!--securecookie host="^\.realty\.mail\.ru$" name="^(realty_geo|rrbrg|saved_segment)$" /-->
	<!--securecookie host="^pro\.realty\.mail\.ru$" name="^REALTYSESS$" /-->
	<!--securecookie host="^pw\.mail\.ru$" name="^(?:bblastactivity|bblastvisit|bbsessionhash|usecache)$" /-->

	<!--	Disable securecookie for this?
		https://mail1.eff.org/pipermail/https-everywhere-rules/2012-December/001422.html
  	-->
	<!--securecookie host="^\.mail\.ru$" name=".+" /-->


	<!--	Tracking cookies:
					-->
	<securecookie host="^\.mail\.ru$" name="^(?:FTID|VID|searchuid)$" />
	<securecookie host="^(?:1link|allods|\.bb|cfire|\.dn|hi-tech|it|\.jd|parapa|pw)\.mail\.ru$" name=".+" />


	<!--	Redirect drops path and args:
						-->
	<rule from="^http://blogs\.mail\.ru/.*"
		to="https://my.mail.ru/" />

		<test url="http://blogs.mail.ru/foo" />

	<rule from="^http://cdn\.connect\.mail\.ru/"
		to="https://connect.mail.ru/" />

	<rule from="^http://content\.foto\.mail\.ru/"
		to="https://content.foto.my.mail.ru/" />

	<rule from="^http://stat\.my\.mail\.ru/"
		to="https://my.mail.ru/" />

	<rule from="^http://img\.pre\.realty\.mail\.ru/"
		to="https://img.realty.mail.ru/" />

	<rule from="^http://(?:\w\w\.){4}top\.mail\.ru/"
		to="https://top-fwz1.mail.ru/" />

		<test url="http://a1.a1.a1.a1.top.mail.ru/" />

	<!--	Redirect drops path but not args:
							-->
	<rule from="^http://wap\.mail\.ru/[^?]*"
		to="https://tel.mail.ru/" />

		<test url="http://wap.mail.ru//" />
		<test url="http://wap.mail.ru/foo" />

	<rule from="^http:"
		to="https:" />

</ruleset>
