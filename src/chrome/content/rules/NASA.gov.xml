<!--
	National Aeronautics and Space Administration

	For rules causing false/broken MCB, see NASA.gov-falsemixed.

	stiesx2-ntrs.larc.nasa.gov, ntrs.larc.nasa.gov, &
	ntrs.nasa.gov are handled in US-government-mismatches.xml.


	CDN buckets:

		- landingimagecatalog-1450153822.us-west-1.elb.amazonaws.com

		- d1p01lglytwktu.cloudfront.net

			- mars.jpl.nasa.gov

		- msfcnasa.r3h.net
			- www.msfc.nasa.gov.edgesuite.net

		- spaceflight.nasa.gov.speedera.net
			- spaceflight.nasa.gov.edgesuite.net

		- www.nasa.gov.speedera.net
			- www.nasa.gov.edgesuite.net


	Nonfunctional domains:

		- (www.)hubblesite.org *
		- m.hubblesite.org *

		- nasa.gov subdomains:

			- aquarius ᵈ

			- afinternal.arc ᵖ
			- www.aviationsystemsdivision.arc ᵖ
			- impact.arc		(shows astrobiology2.arc; mismatched, CN: astrobiology.nasa.gov)
			- lcross.arc ʳ
			- worldwind.arc **
			- builds.worldwind.arc **
			- issues.worldwind.arc **

			- www.argo *
			- cce **
			- www.cdscc		(redirects infinitely, CN: TS Series NAS)
			- climate ʰ
			- www.csbf *
			- earthobservatory *
			- lance-modis.eosdis **
			- gcmd ᵈ
			- genelab **

			- aom.giss *
			- data.giss ʳ
			- gacp.giss ʳ
			- glory.giss ʳ
			- gsfcir.giss *
			- isccp.giss ᵈ
			- pubs.giss ʳ
			- www.giss ʳ

			- gsfc subdomains:

				- apd440 (redirect to non-existent domain)
				- arcade ᵃ
				- asd ᵃ
				- astrophysics ᵃ
				- atmospheres ᵖ
				- cats *
				- iswa.ccmc *
				- decadal (refused)
				- disc ʰ
				- eclipse *
				- eoimages ᵈ
				- exist ᵃ
				- fermi		(redirects to http, expired 2011-12-31)
				- giovanni ᵃ
				- icesat ᵈ
				- jdem
				- landsat ᵖ
				- lws-trt **
				- mirador ᵃ
				- nightglow ᵃ
				- nssdc *
				- oceancolor ᵈ
				- owl ᵃ
				- pace ᵈ
				- pwg ʳ
				- radhome ᵈ
				- seabass ᵈ
				- seadas ᵈ
				- glory (refused)
				- giovanni.sci ᵃ
				- oceandata.sci ᵈ
				- sdo *
				- sma ᵈ
				- sunearthday *
				- tigerz ᵃ
				- trmm ᵈ
				- venustransit *
				- voyager

			- www.hec *
			- corts.hq (refused)
			- dayton.hq *
			- grin.hq *
			- icb *

			- jpl subdomains:

				- (www.)? ʳ
				- blogs ʳ
				- cercla ᵈ
				- cisto **
				- cmds-gis ᵃ
				- dawn ʳ
				- genesismission ʳ
				- gracefo (incomplete cert chain)
				- hydro ʳ
				- careerlaunch ʳ
				- grace		403
				- ipnpr ʳ
				- www.istp *
				- jplnet *
				- maps ʳ
				- neo ʳ
				- opendap ʳ
				- opendap-uat ʳ
				- pds-imaging **
				- photojournal **
				- podaac-tools ʳ
				- space ʳ
				- ssd *
				- stardust ʳ
				- stardustnext ʳ
				- thredds ʳ
				- trs-new *
				- voyager ʳ
				- virtualfieldtrip ᶠ

			- www.jps
			- eol.jsc
			- www.jwst **
			- kepler		(shows astrobiology, CN: astrobiology)
			- science.ksc **
			- www-pao.ksc *

			- ceres.larc *
			- discover-aq.larc
			- geo-cape.larc

			- lisa **
			- lance.nsstc ʰ
			- mynasa		400

			- soho.nascom *
			- sohowww.nascom *
			- stereo-ssc.nascom *
			- umbra.nascom *

			- mcszulu21.ndc ᵃ
			- nix ᵃ
			- www.nsbf ʳ

			- open (expired)

			- atmos.pds **
			- geo.pds *
			- img.pds ᶠ
			- mgmt.pds *
			- ppi.pds **
			- rings.pds *

			- pigiceshelf ᵃ
			- psi ᶠ
			- science		400
			- spaceflight **
			- (www.)?spaceplace ʳ
			- spotthestation *
			- sunearthday **
			- technology		Redirects to ntr.ndc.nasa.gov
			- venustransit *
			- visibleearth *

			- atm.wff ᵈ
			- coastal.wff ᵈ
			- gfo.wff ᵈ
			- glas.wff ᵈ
			- npol.wff ᵈ
			- science.wff ᵈ
			- topex.wff ᵈ
			- uairp.wff ᵈ

	ᵃ Shows another domain
	* Times out
	ᵈ Dropped
	ᶠ Handshake fails
	ʰ Redirects to http
	ᵖ Plaintext reply
	ʳ Refused
	** Refused


	Problematic hosts in *nasa.gov:

		- www.aeronautics ¹
		- appel ᵐ

		- astrobiology2.arc ¹
		- (www.)?space.arc ᶜ
		- (www.)?utm.arc ᶜ
		- worldwind31.arc ᵉ ⁵

		- ccmc.gsfc ᵐ ᵘ
		- kahala2.ccmc.gsfc ᵘ
		- kauai.ccmc.gsfc ᶜ
		- modis.gsfc ᵘ

		- discovery ᵘ
		- www.discovery ᵃ ᵐ ᵘ
		- www.echo ˣ
		- firms.modaps.eosdis ᶜ
		- esto ᵘ
		- www.esto ᵐ ᵘ

		- aeronet.gsfc ᵘ
		- aetd.gsfc ᵘ
		- ccmc.gsfc ᵐ ᵘ
		- esto.gsfc ᵘ
		- gmao.gsfc ᵘ
		- jwst.gsfc ˣ
		- neptune.gsfc ᶜ
		- science.gsfc ᵘ
		- swrc.gsfc ᵉ ¹ ⁵
		- terra.gsfc ¹ ᵘ
		- uae2.gsfc ᶜ ¹

		- (www.)?history ᵐ

		- beacon.jpl ᶜ
		- insight.jpl ᵐ ˣ
		- marsmobile.jpl ⁴
		- marsstaticcdn.jpl ⁴
		- marstrek.jpl ᵐ
		- rosetta.jpl ᵉ ˣ

		- jwst ᵐ ˣ
		- km ᵐ

		- discovery.larc ᵘ ˣ
		- essp.larc ᵘ
		- explorers.larc ᵘ ˣ
		- lws.larc ᵘ ˣ
		- mynasadata.larc ᶜ ˣ
		- newfrontiers.larc ᵘ
		- stiprod.larc ᵘ
		- stiprod-ntrs.larc ᵘ

		- lunarscience ᵘ

		- artgallery.msfc ᵘ
		- discovery.msfc ᵘ
		- discovery-alpha.msfc ᵘ

		- nccs ᵈ
		- esto.ndc ᵘ
		- nepp ᵘ
		- www.nepp ᵐ ᵘ
		- nscs ᵈ
		- www.sti ᶜ
		- terra ᵘ

	ᵃ Shows another domain, preemptable redirect
	ᵈ Dropped, equivalent to another domain or preemptable redirect
	¹ Mismatched
	² 404
	³ Cert only matches heasarc.gsfc
	⁴ Cloudfront
	⁵ Self-signed
	ᵇ Shows default page, preemptable redirect
	ᶜ Server sends no certificate chain, see https://whatsmychaincert.com
	ᵉ Expired
	ᵐ Mismatched
	ᵘ Untrusted root
	ˣ Mixed css


	Partially covered hosts in *nasa.gov:

		- smap.jpl ʰ

	ʰ >=1 path redirects to http


	STS header includes includeSubdomains
	for towerfts.csbf, www.csbf, discovery, esto, esto.gsfc, history, www.history, discovery.msfc, discovery.msfc, esto.ndc, nepp, towerfts.csbf, www.csbf


	These altnames do not exist:

		- www.c3.nasa.gov
		- visual.gsfc.nasa.gov
		- www.lists.nasa.gov
		- utm.nasa.gov
		- www.utm.nasa.gov


	Insecure cookies are set for these hosts: ᶜ

		- access.earthdata.nasa.gov
		- ecc.earthdata.nasa.gov
		- search.earthdata.nasa.gov
		- urs.earthdata.nasa.gov

		- firms.modaps.eosdis.nasa.gov
		- exoplanets.nasa.gov
		- flightopportunities.nasa.gov
		- neptune.gsfc.nasa.gov

		- cancer.jpl.nasa.gov
		- edrn.jpl.nasa.gov
		- nisar.jpl.nasa.gov
		- saturn.jpl.nasa.gov
		- sealevel.jpl.nasa.gov
		- swot.jpl.nasa.gov

		- lsda.jsc.nasa.gov
		- answers.nssc.nasa.gov
		- sage.nasa.gov

	ᶜ See https://owasp.org/index.php/SecureFlag


	Mixed content:

		- iframe on employeeorientation, jwst.gsfc, jwst, www.echo from www.youtube.com ¹

		- css, on:

			- employeeorientation from $self ¹
			- jwst.gsfc, jwst from jwst.nasa.gov ¹
			- insight.jpl from solarsystem.nasa.gov ¹
			- rosetta.jpl from $self ᵉ
			- discovery.larc, explorers.larc, lws.larc from soma.larc.nasa.gov ᵘ
			- mynasadata.larc from $self
			- kauai.ccmc.gsfc, nisar.jpl, oig, pds-engineering from fonts.googleapis.com ¹
			- sage from $self ¹
			- www.sti from $self

		- Images, on:

			- appel from $self ᵐ
			- appel, km from wpsites.nasawestprime.com
			- (www.)?space.arc from astrobiology.nasa.gov ¹
			- (www.)?space.arc from sservi.nasa.gov
			- discovery, pub.lmmp, discovery.msfc from www.adobe.com ¹
			- jwst.gsfc, jwst from jwst.nasa.gov ¹
			- modis.gsfc from $self ᵘ
			- neptune.gsfc from $self
			- (www.)?history, sage from www.nasa.gov ¹
			- insight.jpl from $self
			- insight.jpl, mars.jpl from mars.nasa.gov ¹
			- insight.jpl from solarsystem.nasa.gov ¹
			- podaac-www from podaac.jpl.nasa.gov ¹
			- rosetta.jpl from $self ᵉ
			- scienceandtechnology.jpl from www-robotics.jpl ¹
			- lsda.jsc from $self
			- km from appel.nasa.gov ᵐ
			- km from $self ᵐ
			- discovery.larc, essp.larc, newfrontiers.larc from soma.larc.nasa.gov ᵘ
			- explorers.larc from $self ᵘ
			- mynasadata.larc from $self
			- discovery-alpha.msfc from mcszulu21.ndc.nasa.gov ᵃ
			- www.nccs from www.hec.nasa.gov
			- www.nccs from nccs.nasa.gov
			- www.nccs from $self
			- sage from $self ¹
			- open from $self ¹
			- ppm from trmm.gsfc.nasa.gov ᵈ
			- www.sti from $self
			- www from $self ¹

		- favicons, on:

			- essp.larc, explorers.larc, lws.larc, newfrontiers.larc from soma.larc.nasa.gov ᵘ

		- Bugs, on:

			- scienceandtechnology.jpl from static.addtoany.com ¹
			- nccs from twitter-badges.s3.amazonaws.com ¹
			- podaac.jpl, podaac-www.jpl, ghrc.nsstc from ws1.ems.eosdis.nasa.gov ¹

	ᵃ Unsecurable <= shows another domain
	ᵈ Unsecurable <= dropped
	ᵉ Not secured by us <= expired
	ᵐ Not secured by us <= mismatched
	¹ Secured by us, see https://www.paulirish.com/2010/the-protocol-relative-url/
	ˢ Secured by us, see https://www.paulirish.com/2010/the-protocol-relative-url/
	ᵘ Not secured by us <= untrusted root

-->
<ruleset name="NASA.gov (partial)">

	<!--	Direct rewrites:
				-->
	<target host="nasa.gov" />
	<target host="airbornescience.nasa.gov" />
	<target host="apod.nasa.gov" />
	<target host="applyonline.nasa.gov" />

	<target host="cloud1.arc.nasa.gov" />
	<!--target host="space.arc.nasa.gov" /-->
	<!--target host="www.space.arc.nasa.gov" /-->

	<target host="astrobiology.nasa.gov" />
	<target host="astronauts.nasa.gov" />

	<target host="towerfts.csbf.nasa.gov" />
	<target host="*.towerfts.csbf.nasa.gov" />
	<target host="www.csbf.nasa.gov" />

	<target host="blogs.nasa.gov" />
	<target host="c3.nasa.gov" />
	<target host="code.nasa.gov" />
	<target host="data.nasa.gov" />
	<target host="earthdata.nasa.gov" />

	<target host="access.earthdata.nasa.gov" />
	<target host="cdn.earthdata.nasa.gov" />
	<target host="ecc.earthdata.nasa.gov" />
	<target host="search.earthdata.nasa.gov" />
	<target host="urs.earthdata.nasa.gov" />
	<target host="wiki.earthdata.nasa.gov" />

	<!--target host="www.echo.nasa.gov" /-->
	<target host="employeeorientation.nasa.gov" />
	<target host="eods.nasa.gov" />

	<target host="ws1.ems.eosdis.nasa.gov" />
	<!--target host="firms.modaps.eosdis.nasa.gov" /-->

	<target host="esdpubs.nasa.gov" />
	<target host="espo.nasa.gov" />
	<target host="www.espo.nasa.gov" />
	<target host="spacecomm.nasa.gov" />
	<target host="www.spacecomm.nasa.gov" />
	<target host="espoarchive.nasa.gov" />
	<target host="exoplanets.nasa.gov" />
	<target host="eyes.nasa.gov" />
	<target host="flightopportunities.nasa.gov" />
	<target host="gpm.nasa.gov" />

	<target host="rt.grc.nasa.gov" />
	<target host="wordpress.grc.nasa.gov" />
	<target host="www.grc.nasa.gov" />

	<target host="acemission.gsfc.nasa.gov" />
	<target host="apod.gsfc.nasa.gov" />
	<target host="aura.gsfc.nasa.gov" />
	<!--target host="kauai.ccmc.gsfc.nasa.gov" /-->
	<target host="cilab.gsfc.nasa.gov" />
	<target host="cor.gsfc.nasa.gov" />
	<target host="cosmicopia.gsfc.nasa.gov" />
	<target host="daac.gsfc.nasa.gov" />
	<!-- target host="decadal.gsfc.nasa.gov" / -->
	<target host="ehpd.gsfc.nasa.gov" />
	<target host="explorers.gsfc.nasa.gov" />
	<target host="fits.gsfc.nasa.gov" />
	<target host="fpd.gsfc.nasa.gov" />
	<!-- target host="glory.gsfc.nasa.gov" / -->
	<target host="gms.gsfc.nasa.gov" />
	<target host="heasarc.gsfc.nasa.gov" />
	<target host="hires.gsfc.nasa.gov" />
	<target host="iris.gsfc.nasa.gov" />
	<target host="ixo.gsfc.nasa.gov" />
	<target host="jointmission.gsfc.nasa.gov" />
	<!--target host="jwst.gsfc.nasa.gov" /-->
	<target host="lambda.gsfc.nasa.gov" />
	<target host="lola.gsfc.nasa.gov" />
	<target host="lunar.gsfc.nasa.gov" />
	<target host="lws.gsfc.nasa.gov" />
	<target host="lws-set.gsfc.nasa.gov" />
	<target host="mms.gsfc.nasa.gov" />
	<target host="nasaviz.gsfc.nasa.gov" />
	<!--target host="neptune.gsfc.nasa.gov" /-->
	<target host="pmm.gsfc.nasa.gov" />
	<target host="poes.gsfc.nasa.gov" />
	<target host="rsdo.gsfc.nasa.gov" />
	<target host="satellitesafety.gsfc.nasa.gov" />
	<target host="disc.sci.gsfc.nasa.gov" />
	<target host="ssco.gsfc.nasa.gov" />
	<target host="stp.gsfc.nasa.gov" />
	<target host="sustainablelandimaging.gsfc.nasa.gov" />
	<target host="svs.gsfc.nasa.gov" />
	<target host="tess.gsfc.nasa.gov" />

	<!-- target host="corts.hq.nasa.gov" / -->
	<target host="www.hq.nasa.gov" />
	<target host="intern.nasa.gov" />
	<target host="invention.nasa.gov" />

	<target host="acquisition.jpl.nasa.gov" />
	<!--target host="beacon.jpl.nasa.gov" /-->
	<!--<target host="cancer.jpl.nasa.gov" />-->
	<target host="dir.jpl.nasa.gov" />
	<target host="directory.jpl.nasa.gov" />
	<target host="edrn.jpl.nasa.gov" />
	<target host="enose.jpl.nasa.gov" />
	<target host="exep.jpl.nasa.gov" />
	<target host="exoplanets.jpl.nasa.gov" />
	<target host="eyes.jpl.nasa.gov" />
	<target host="eyesstage.jpl.nasa.gov" />
	<!-- target host="gracefo.jpl.nasa.gov" / -->
	<target host="hyspiri.jpl.nasa.gov" />
	<target host="icis.jpl.nasa.gov" />
	<target host="jpldataeval.jpl.nasa.gov" />
	<target host="jplspaceship.jpl.nasa.gov" />
	<target host="mars.jpl.nasa.gov" />
	<target host="marsrovers.jpl.nasa.gov" />
	<target host="naif.jpl.nasa.gov" />
	<target host="nightsky.jpl.nasa.gov" />
	<target host="nisar.jpl.nasa.gov" />
	<target host="pds.jpl.nasa.gov" />
	<target host="pds-engineering.jpl.nasa.gov" />
	<target host="planetquest.jpl.nasa.gov" />
	<target host="podaac.jpl.nasa.gov" />
	<target host="podaac-uat.jpl.nasa.gov" />
	<target host="podaac-www.jpl.nasa.gov" />
	<target host="ras.jpl.nasa.gov" />
	<target host="saturn.jpl.nasa.gov" />
	<target host="science.jpl.nasa.gov" />
	<target host="scienceandtechnology.jpl.nasa.gov" />
	<target host="sealevel.jpl.nasa.gov" />
	<!--target host="smap.jpl.nasa.gov" /-->
	<target host="solarsystem.jpl.nasa.gov" />
	<target host="studentprograms.jpl.nasa.gov" />
	<target host="swot.jpl.nasa.gov" />
	<target host="technology.jpl.nasa.gov" />
	<target host="www-robotics.jpl.nasa.gov" />

	<target host="lsda.jsc.nasa.gov" />
	<target host="clarreo.larc.nasa.gov" />
	<!--target host="mynasadata.larc.nasa.gov" /-->
	<target host="launchpad.nasa.gov" />
	<target host="auth.launchpad.nasa.gov" />
	<target host="lists.nasa.gov" />
	<target host="see.msfc.nasa.gov" />
	<target host="nasajobs.nasa.gov" />
	<target host="nasapeople.nasa.gov" />
	<target host="www.nccs.nasa.gov" />

	<target host="genelab-data.ndc.nasa.gov" />
	<target host="gs66-vdclambda.ndc.nasa.gov" />
	<target host="mail01.ndc.nasa.gov" />

	<target host="neba.nasa.gov" />
	<target host="towerfts.nsbf.nasa.gov" />
	<target host="*.towerfts.nsbf.nasa.gov" />
	<target host="nasasearch.nasa.gov" />
	<target host="*.nasasearch.nasa.gov" />

	<target host="answers.nssc.nasa.gov" />
	<target host="searchpub.nssc.nasa.gov" />
	<target host="www.nssc.nasa.gov" />

	<target host="ghrc.nsstc.nasa.gov" />
	<target host="ntrs.nasa.gov" />
	<target host="oig.nasa.gov" />
	<!-- target host="open.nasa.gov" / -->
	<target host="pds.nasa.gov" />
	<target host="people.nasa.gov" />
	<target host="pmm.nasa.gov" />
	<target host="retiree.nasa.gov" />
	<target host="sage.nasa.gov" />
	<target host="satern.nasa.gov" />
	<target host="software.nasa.gov" />
	<target host="solarsystem.nasa.gov" />
	<target host="spinoff.nasa.gov" />
	<target host="sservi.nasa.gov" />
	<!--target host="www.sti.nasa.gov" /-->
	<target host="webmail.nasa.gov" />
	<target host="www.nasa.gov" />

		<!--	includeSubdomains applies to one level only, so:
									-->
		<exclusion pattern="^http://(?:[^./]+\.){2,}(?:towerfts\.[cn]sbf|nasasearch)\.nasa\.gov/" />

			<!--	+ve:
					-->
			<test url="http://this.host.towerfts.csbf.nasa.gov/" />
			<test url="http://exists.not.towerfts.csbf.nasa.gov/" />
			<test url="http://this.host.nasasearch.nasa.gov/" />
			<test url="http://exists.not.nasasearch.nasa.gov/" />
			<test url="http://this.host.towerfts.nsbf.nasa.gov/" />
			<test url="http://exists.not.towerfts.nsbf.nasa.gov/" />

	<!--	Complications:
				-->
	<target host="helios.gsfc.nasa.gov" />
	<target host="www.gsfc.nasa.gov" />

	<target host="heasarc.nasa.gov" />

	<target host="marsstaticcdn.jpl.nasa.gov" />

	<!--target host="jwst.nasa.gov" /-->
	<target host="mars.nasa.gov" />
	<target host="www.msfc.nasa.gov" />
	<target host="nccs.nasa.gov" />
	<target host="nscs.nasa.gov" />
	<target host="search.nasa.gov" />

		<!--	Redirects to http:
						-->
		<!--exclusion pattern="^http://smap\.jpl\.nasa\.gov/$" /-->
		<!--
			Exceptions:
					-->
		<!--exclusion pattern="^http://smap\.jpl\.nasa\.gov/(?!/*(?:assets|system)/)" /-->

			<!--	+ve:
					-->
			<!--
			<test url="http://smap.jpl.nasa.gov/documents" />
			<test url="http://smap.jpl.nasa.gov/feedback" />
			<test url="http://smap.jpl.nasa.gov/map" />
			-->

			<!--	-ve:
					-->
			<!--
			<test url="http://smap.jpl.nasa.gov/assets/arrow_down_prompt.png" />
			<test url="http://smap.jpl.nasa.gov/system/internal_resources/details/original/258_ERN-Ad.jpg" />
			-->

		<!--	Mixed css:
					-->
		<!--test url="http://www.echo.nasa.gov/reverb/about_reverb.htm" /-->

		<!--	Mixed images:
					-->
		<!--test url="http://mars.jpl.nasa.gov/blogs/" /-->
		<!--test url="http://mars.jpl.nasa.gov/mer/home/" /-->
		<!--test url="http://www.nasa.gov/centers/glenn/home/index.html" /-->


	<securecookie host=".+" name=".+" />


	<!--	Redirect keeps all:
					-->
	<rule from="^http://nccs\.nasa\.gov/"
		to="https://www.nccs.nasa.gov/" />

	<!--	Redirect drops all:
					-->
	<rule from="^http://nscs\.nasa\.gov/.*"
		to="https://nasapeople.nasa.gov/redirect.htm" />

		<test url="http://nscs.nasa.gov/nscs_lp.htm" />

	<rule from="^http:"
		to="https:" />

</ruleset>
