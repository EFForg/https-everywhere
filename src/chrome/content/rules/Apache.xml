<!--
	For rules causing false/broken MCB, see Apache.org-falsemixed.xml.


	Other Apache rulesets:

		- ApacheCon.com.xml
		- Apache-OpenOffice.xml


	Nonfunctional subdomains:

		- feathercast ʳ
		- ooo-forums ʳ
		- vmgump ʳ

	ʳ Refused


	Problematic subdomains:

		- ^ ᵐ
		- activemq ˣ
		- aries ˣ
		- geronimo ˣ
		- helix ˣ
		- lucy ˣ
		- mail-archives (incomplete cert chain)
		- santuario ˣ
		- tuscany ˣ
		- www.us ᵐ

	ᵐ Cert only matches *.apache.org
	ˣ Mixed css


	Partially covered subdomains:

		- activemq ˣ
		- aries ˣ
		- geronimo ˣ
		- helix ˣ
		- lucy ˣ
		- santuario ˣ
		- tuscany ˣ

	ˣ Avoiding false/broken MCB


	Fully covered domains:

		- (www.)apache.org	(^ → www)

		- *.apache.org:

			- accumulo
			- abdera
			- ace
			- airavata
			- allura
			- ambari
			- analysis
			- ant
			- any23
			- apr
			- archiva
			- archive
			- avro
			- axis
			- bigtop
			- blogs
			- bloodhound
			- buildr
			- builds
			- bval
			- camel
			- cassandra
			- cayenne
			- chemistry
			- chukwa
			- clerezza
			- climate
			- cloudstack
			- cocoon
			- comments
			- commons
			- community
			- continuum
			- couchdb
			- creadur
			- crunch
			- ctakes
			- curator
			- cwiki
			- cxf
			- db
			- deltacloud
			- directmemory
			- directory
			- drill
			- empire-db
			- etch
			- felix
			- flex
			- flume
			- forge-allura
			- forrest
			- giraph
			- git-wip-us
			- gora
			- gump
			- hadoop
			- hama
			- hbase
			- hc
			- hive
			- httpd
			- incubator
			- spark.incubator
			- tez.incubator
			- isis
			- issues
			- jakarta
			- james
			- jclouds
			- jena
			- jmeter
			- jspwiki
			- jspwiki-wiki
			- juddi
			- kafka
			- knox
			- labs
			- lenya
			- libcloud
			- logging
			- lucene
			- lucenenet
			- mahout
			- manifoldcf
			- marmotta
			- maven
			- repo.maven
			- mesos
			- mina
			- mrunit
			- myfaces
			- nutch
			- ode
			- ofbiz
			- olingo
			- oltu
			- onami
			- oozie
			- openjpa
			- openmeetings
			- opennlp
			- openoffice
			- openwebbeans
			- pdfbox
			- people
			- perl
			- pig
			- pivot
			- poi
			- portals
			- qpid
			- rave
			- reviews
			- river
			- roller
			- s
			- servicemix
			- shindig
			- shiro
			- sis
			- sling
			- spamassassin
			- spark
			- sqoop
			- stanbol
			- steve
			- struts
			- svn
			- subversion
			- synapse
			- syncope
			- tajo
			- tapestry
			- tcl
			- tez
			- thrift
			- tika
			- tiles
			- tomcat
			- tomee
			- trafficserver
			- turbine
			- uima
			- www.us	(→ ^www.apache.org)
			- vcl
			- velocity
			- vxquery
			- whirr
			- wicket
			- wiki
			- wink
			- wookie
			- ws
			- xalan
			- xerces
			- xml
			- xmlbeans
			- xmlgraphics
			- zookeeper


	Mixed content:

		- iframes, on:

			- archiva, shiro, and tomee from www.youtube.com ¹
			- gora and nutch from prezi.com ¹
			- gora from www.slideshare.net ¹

		- css, on:

			- activemq from $self ¹
			- aries from $self ¹
			- creadur, drill, kafka, marmotta, synapse, trafficserver, www from fonts.googleapis.com ¹
			- geronimo from $self ¹
			- helix from netdna.bootstrapcdn.com ¹
			- lucy from $self ¹
			- santuario from cxf ¹
			- sis and xmlgraphics from www ¹
			- tuscany from $self ¹

		- Images, on:

			- ant, any23, bigtop, bloodhound, commons, continuum, creadur, ctakes, flex, forrest, gump, hc, lenya, nutch, oltu, oozie, openwebbeans, projects, shindig, sqoop, trafficserver, whir, www, and xerces from www ¹
			- archiva from $self ¹
			- aries from $self ¹
			- blogs from people ¹
			- builds and sling from incubator ¹
			- camel from $self ¹
			- commons, hc, and tajo from maven ¹
			- crunch from hadoop ¹
			- curator and tajo from ^ ¹
			- cxf from $self ¹
			- geronimo from $self ¹
			- karaf from $self ¹
			- knox from $self ¹
			- lucy from $self ¹
			- mahout from $self ¹
			- openoffice from www.openoffice.org ¹
			- santuario from activemq ¹
			- tajo from maven ¹
			- tapestry from $self ¹
			- tika from $self ¹
			- tiles from struts ¹
			- tuscany from $self ¹

		- favicon on mahout from $self ¹

		- Ads/bugs, on:

			- archiva, bigtop, buildr, directmemory, giraph, onami, oozie, openwebbeans, sqoop, tajo, and ws from www.google.com ¹
			- bloodhound from ghbtns.com ¹
			- buildr from www.jetbrains.com ¹
			- cayenne from $self ¹
			- geronimo from static.delicious.com
			- geronimo from digg.com ¹
			- gora from www.datastax.com ²
			- nutch from apachecon.com ³
			- nutch from typo3.org ¹
			- ofbiz from go.linuxfoundation.org ¹
			- openwebbeans from twitter.github.com ¹
			- tuscany from www.google-analytics.com ¹
			- tuscany from c26.statcounter.com ¹
			- xmlgraphics from www.apache.org ¹

	¹ Secured by us
	² Unsecurable <= refused
	³ Not secured by us <= mismatched

-->
<ruleset name="Apache.org (partial)">

	<target host="apache.org" />
	<target host="*.apache.org" />

		<exclusion pattern="^http://(?:feathercast|ooo-forums|vmgump)\.apache\.org/" />

			<!--	+ve:
					-->
			<test url="http://feathercast.apache.org/" />
			<test url="http://ooo-forums.apache.org/" />
			<test url="http://vmgump.apache.org/" />

		<!--	Avoid false/broken MCB:
						-->
		<!--exclusion pattern="^http://activemq\.apache\.org/+(?!favicon\.ico|style/)" /-->
		<!--exclusion pattern="^http://aries\.apache\.org/+(?!favicon\.ico|images/|resources/)" /-->
		<!--exclusion pattern="^http://geronimo\.apache\.org/+(?!favicon\.ico|images/|style/)" /-->
		<!--exclusion pattern="^http://(helix|lucy)\.apache\.org/+(?!css/|favicon\.ico|images/)" /-->
		<!--exclusion pattern="^http://santuario\.apache\.org/+(?!favicon\.ico)" /-->
		<!--exclusion pattern="^http://tuscany\.apache\.org/+(?!favicon\.ico|images/|stylesheets/)" /-->
		<!--
			In sum:
				-->
		<exclusion pattern="^http://(?:activemq|aries|geronimo|helix|lucy|santuario|tuscany)\.apache\.org/(?!/*(?:css/|favicon\.ico|images/|style/|stylesheets/))" />

			<!--	+ve:
					-->
			<test url="http://activemq.apache.org/cms/" />
			<test url="http://aries.apache.org/development/ReleaseProcessRequirements.html" />
			<test url="http://geronimo.apache.org/events.html" />
			<test url="http://helix.apache.org/Architecture.html" />
			<test url="http://lucy.apache.org/docs/" />
			<test url="http://santuario.apache.org/faq.html" />
			<test url="http://tuscany.apache.org/getting-involved.html" />

			<!--	-ve:
					-->
			<test url="http://activemq.apache.org/favicon.ico" />
			<test url="http://aries.apache.org/favicon.ico" />
			<test url="http://geronimo.apache.org/favicon.ico" />
			<test url="http://helix.apache.org/favicon.ico" />
			<test url="http://lucy.apache.org/favicon.ico" />
			<test url="http://santuario.apache.org/favicon.ico" />
			<test url="http://tuscany.apache.org/favicon.ico" />

		<test url="http://accumulo.apache.org/" />
		<test url="http://abdera.apache.org/" />
		<test url="http://ace.apache.org/" />
		<test url="http://activemq.apache.org/" />
		<test url="http://airavata.apache.org/" />
		<test url="http://allura.apache.org/" />
		<test url="http://ambari.apache.org/" />
		<test url="http://analysis.apache.org/" />
		<test url="http://ant.apache.org/" />
		<test url="http://any23.apache.org/" />
		<test url="http://apr.apache.org/" />
		<test url="http://archiva.apache.org/" />
		<test url="http://archive.apache.org/" />
		<test url="http://aries.apache.org/" />
		<test url="http://attic.apache.org/" />
		<test url="http://avro.apache.org/" />
		<test url="http://axis.apache.org/" />
		<test url="http://bigtop.apache.org/" />
		<test url="http://blogs.apache.org/" />
		<test url="http://bloodhound.apache.org/" />
		<test url="http://buildr.apache.org/" />
		<test url="http://builds.apache.org/" />
		<test url="http://bval.apache.org/" />
		<test url="http://camel.apache.org/" />
		<test url="http://cassandra.apache.org/" />
		<test url="http://cayenne.apache.org/" />
		<test url="http://chemistry.apache.org/" />
		<test url="http://chukwa.apache.org/" />
		<test url="http://ci.apache.org/" />
		<test url="http://clerezza.apache.org/" />
		<test url="http://climate.apache.org/" />
		<test url="http://cloudstack.apache.org/" />
		<test url="http://cocoon.apache.org/" />
		<test url="http://comments.apache.org/" />
		<test url="http://commons.apache.org/" />
		<test url="http://community.apache.org/" />
		<test url="http://continuum.apache.org/" />
		<test url="http://couchdb.apache.org/" />
		<test url="http://creadur.apache.org/" />
		<test url="http://crunch.apache.org/" />
		<test url="http://ctakes.apache.org/" />
		<test url="http://curator.apache.org/" />
		<test url="http://cwiki.apache.org/" />
		<test url="http://cxf.apache.org/" />
		<test url="http://db.apache.org/" />
		<test url="http://deltacloud.apache.org/" />
		<test url="http://directmemory.apache.org/" />
		<test url="http://directory.apache.org/" />
		<test url="http://drill.apache.org/" />
		<test url="http://empire-db.apache.org/" />
		<test url="http://etch.apache.org/" />
		<test url="http://felix.apache.org/" />
		<test url="http://flex.apache.org/" />
		<test url="http://flume.apache.org/" />
		<test url="http://forge-allura.apache.org/" />
		<test url="http://forrest.apache.org/" />
		<test url="http://geronimo.apache.org/" />
		<test url="http://giraph.apache.org/" />
		<test url="http://git.apache.org/" />
		<test url="http://git-wip-us.apache.org/" />
		<test url="http://gora.apache.org/" />
		<test url="http://gump.apache.org/" />
		<test url="http://hadoop.apache.org/" />
		<test url="http://hama.apache.org/" />
		<test url="http://hbase.apache.org/" />
		<test url="http://hc.apache.org/" />
		<test url="http://helix.apache.org/" />
		<test url="http://hive.apache.org/" />
		<test url="http://httpd.apache.org/" />
		<test url="http://incubator.apache.org/" />
		<test url="http://spark.incubator.apache.org/" />
		<test url="http://tez.incubator.apache.org/" />
		<test url="http://isis.apache.org/" />
		<test url="http://issues.apache.org/" />
		<test url="http://jackrabbit.apache.org/" />
		<test url="http://jakarta.apache.org/" />
		<test url="http://james.apache.org/" />
		<test url="http://jclouds.apache.org/" />
		<test url="http://jena.apache.org/" />
		<test url="http://jmeter.apache.org/" />
		<test url="http://jspwiki.apache.org/" />
		<test url="http://jspwiki-wiki.apache.org/" />
		<test url="http://juddi.apache.org/" />
		<test url="http://kafka.apache.org/" />
		<test url="http://knox.apache.org/" />
		<test url="http://labs.apache.org/" />
		<test url="http://lenya.apache.org/" />
		<test url="http://libcloud.apache.org/" />
		<test url="http://logging.apache.org/" />
		<test url="http://lucene.apache.org/" />
		<test url="http://lucenenet.apache.org/" />
		<test url="http://lucy.apache.org/" />
		<test url="http://mahout.apache.org/" />
		<test url="http://manifoldcf.apache.org/" />
		<test url="http://marmotta.apache.org/" />
		<test url="http://maven.apache.org/" />
		<test url="http://repo.maven.apache.org/" />
		<test url="http://mesos.apache.org/" />
		<test url="http://mina.apache.org/" />
		<test url="http://mrunit.apache.org/" />
		<test url="http://myfaces.apache.org/" />
		<test url="http://nutch.apache.org/" />
		<test url="http://ode.apache.org/" />
		<test url="http://ofbiz.apache.org/" />
		<test url="http://olingo.apache.org/" />
		<test url="http://oltu.apache.org/" />
		<test url="http://onami.apache.org/" />
		<test url="http://oodt.apache.org/" />
		<test url="http://oozie.apache.org/" />
		<test url="http://openjpa.apache.org/" />
		<test url="http://openmeetings.apache.org/" />
		<test url="http://opennlp.apache.org/" />
		<test url="http://openoffice.apache.org/" />
		<test url="http://openwebbeans.apache.org/" />
		<test url="http://pdfbox.apache.org/" />
		<test url="http://people.apache.org/" />
		<test url="http://perl.apache.org/" />
		<test url="http://pig.apache.org/" />
		<test url="http://pivot.apache.org/" />
		<test url="http://poi.apache.org/" />
		<test url="http://portals.apache.org/" />
		<test url="http://qpid.apache.org/" />
		<test url="http://rave.apache.org/" />
		<test url="http://reviews.apache.org/" />
		<test url="http://river.apache.org/" />
		<test url="http://roller.apache.org/" />
		<test url="http://s.apache.org/" />
		<test url="http://santuario.apache.org/" />
		<test url="http://servicemix.apache.org/" />
		<test url="http://shindig.apache.org/" />
		<test url="http://shiro.apache.org/" />
		<test url="http://sis.apache.org/" />
		<test url="http://sling.apache.org/" />
		<test url="http://spamassassin.apache.org/" />
		<test url="http://spark.apache.org/" />
		<test url="http://sqoop.apache.org/" />
		<test url="http://stanbol.apache.org/" />
		<test url="http://steve.apache.org/" />
		<test url="http://struts.apache.org/" />
		<test url="http://svn.apache.org/" />
		<test url="http://subversion.apache.org/" />
		<test url="http://synapse.apache.org/" />
		<test url="http://syncope.apache.org/" />
		<test url="http://tajo.apache.org/" />
		<test url="http://tapestry.apache.org/" />
		<test url="http://tcl.apache.org/" />
		<test url="http://tez.apache.org/" />
		<test url="http://thrift.apache.org/" />
		<test url="http://tika.apache.org/" />
		<test url="http://tiles.apache.org/" />
		<test url="http://tomcat.apache.org/" />
		<test url="http://tomee.apache.org/" />
		<test url="http://trafficserver.apache.org/" />
		<test url="http://turbine.apache.org/" />
		<test url="http://tuscany.apache.org/" />
		<test url="http://uima.apache.org/" />
		<test url="http://vcl.apache.org/" />
		<test url="http://velocity.apache.org/" />
		<test url="http://vxquery.apache.org/" />
		<test url="http://whirr.apache.org/" />
		<test url="http://wicket.apache.org/" />
		<test url="http://wiki.apache.org/" />
		<test url="http://wink.apache.org/" />
		<test url="http://wookie.apache.org/" />
		<test url="http://ws.apache.org/" />
		<test url="http://www.apache.org/" />
		<test url="http://xalan.apache.org/" />
		<test url="http://xerces.apache.org/" />
		<test url="http://xml.apache.org/" />
		<test url="http://xmlbeans.apache.org/" />
		<test url="http://xmlgraphics.apache.org/" />
		<test url="http://zookeeper.apache.org/" />


	<!--	Not secured by server:
					-->
	<!--securecookie host="^(analysis|builds|cwiki|jspwiki-wiki)\.apache\.org$" name="^JSESSIONID$" /-->

	<securecookie host="^(?:.+\.)?apache\.org$" name=".+" />


	<rule from="^http://apache\.org/"
		to="https://www.apache.org/" />

	<rule from="^http://www\.us\.apache\.org/"
		to="https://www.apache.org/" />

		<test url="http://www.us.apache.org/" />

	<rule from="^http:"
		to="https:" />

</ruleset>
