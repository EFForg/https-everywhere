<!--
	University of Southern California

	For rules false/broken MCB, see USC.edu-falsemixed.xml.

	For problematic rules, see University-of-Southern-California-mismatches.xml.


	Nonfunctional hosts in *usc.ed:

		- annenberg ¹
		- chan ²
		- ee ³
		- election2012 ⁴
		- emergency ⁵
		- gero ⁶
		- gould ²
		- ict ¹
		- (www.)?international ¹
		- iovine-young ¹
		- keck ²
		- (www.)?law ²
		- libraries-emergency ⁵
		- mylaw2 ²
		- passwordreset.provost ²
		- transnet ¹
		- trojanlearn ³
		- viterbi ¹

	¹ Dropped
	² Refused
	³ Shows another domain
	⁴ $ displays white page; paths 404
	⁵ Handshake fails
	⁶ Plaintext reply


	Problematic hosts in *usc.ed:

		- ^ ¹
		- adminopsnet ²
		- caps-intranet ²
		- capsnet ³ ²
		- www.dornsife ³
		- dornsifelive ³ ⁴
		- healthstream ⁵
		- keckapps ⁵
		- service.marshall ⁶
		- students.marshall ³ ⁴
		- policies ⁶
		- pt ³
		- roski ⁵
		- think ³

	¹ Refused
	² Untrusted root
	³ Mismatched
	⁴ Expired
	⁵ Mixed css
	⁶ Shows another domain


	Mixed content:

		- css, on:

			- healthstream from keckapps.usc.edu *
			- keckapps, roski from $self *

		- Images, on:

			- adminit from zapt4.staticworld.net
			- arch, iastudents, keckapps, kortschakcenter, www.marshall, pharmacycorefacilities, policy, help.provost, roski, wise, www from $self *
			- dornsife from dornsifelive.usc.edu *
			- employees from l.yimg.com *
			- healthstream from keckapps.usc.edu *
			- my from feeds.feedburner.com *
			- policy from www.usc.edu *
			- sarc from customsites.usc.edu *
			- wise from www.web-nex.com
			- www from web-app.usc.edu *

		- favicon on about, academics, accreditation, benefits, bknpt-web5.bknpt, blackboardhelp, classes, commencement, dentistry, it-security, kaufman, pharmacies, rossierstudents, strategic, studentblackboardhelp from www.usc.edu *
		- Bug on kaufman from \d+.fls.doubleclick.net

	* Secured by us

-->
<ruleset name="USC.edu (partial)">

	<!--	Direct rewrites:
				-->
	<target host="about.usc.edu" />
	<target host="academics.usc.edu" />
	<target host="accreditation.usc.edu" />
	<target host="adminit.usc.edu" />
	<target host="arch.usc.edu" />
	<target host="benefits.usc.edu" />
	<target host="bknpt-web5.bknpt.usc.edu" />
	<target host="blackboard.usc.edu" />
	<target host="blackboardhelp.usc.edu" />
	<target host="businessservices.usc.edu" />
	<target host="careers.usc.edu" />
	<target host="mail.capsd.usc.edu" />
	<target host="caps-login.usc.edu" />
	<target host="capstechops.usc.edu" />
	<target host="cinema.usc.edu" />
	<target host="cio.usc.edu" />
	<target host="campaign.usc.edu" />
	<target host="campusactivities.usc.edu" />
	<target host="classes.usc.edu" />
	<target host="commencement.usc.edu" />
	<target host="cst.usc.edu" />
	<target host="customsites.usc.edu" />
	<target host="dentistry.usc.edu" />
	<target host="dornsifecms.usc.edu" />
	<target host="dornsife.usc.edu" />
	<target host="dps.usc.edu" />
	<target host="dpspreview.usc.edu" />
	<target host="dramaticarts.usc.edu" />
	<target host="ecohenshc.usc.edu" />
	<target host="email.usc.edu" />
	<target host="employees.usc.edu" />
	<target host="engemannshc.usc.edu" />
	<target host="facultypositions.usc.edu" />
	<target host="fbs.usc.edu" />
	<target host="stats.fs.usc.edu" />
	<target host="giveto.usc.edu" />
	<target host="google.usc.edu" />
	<target host="hcda.usc.edu" />
	<target host="hcdapreview.usc.edu" />
	<!--target host="healthstream.usc.edu" /-->
	<target host="housing.usc.edu" />
	<target host="hpcc.usc.edu" />
	<target host="hrdivision.usc.edu" />
	<target host="iastudents.usc.edu" />
	<target host="istar.usc.edu" />
	<target host="istar-chla.usc.edu" />
	<target host="it-security.usc.edu" />
	<target host="italerts.usc.edu" />
	<target host="itservices.usc.edu" />
	<target host="itsupport.usc.edu" />
	<target host="jobs.usc.edu" />
	<target host="kaufman.usc.edu" />
	<!--target host="keckapps.usc.edu" /-->
	<target host="kfs.usc.edu" />
	<target host="kortschakcenter.usc.edu" />
	<target host="learningdesign.usc.edu" />
	<target host="lgbtrc.usc.edu" />
	<target host="marshall.usc.edu" />
	<target host="interview.marshall.usc.edu" />
	<target host="managers.usc.edu" />
	<target host="www.marshall.usc.edu" />
	<target host="marshallapps.usc.edu" />
	<target host="keckselfservice.med.usc.edu" />
	<target host="myshr.med.usc.edu" />
	<target host="music.usc.edu" />
	<target host="my.usc.edu" />
	<target host="mydornsife.usc.edu" />
	<target host="mymarshall.usc.edu" />
	<target host="netid.usc.edu" />
	<target host="news.usc.edu" />
	<target host="online.usc.edu" />
	<target host="parents.usc.edu" />
	<target host="pharmacies.usc.edu" />
	<target host="pharmacycorefacilities.usc.edu" />
	<target host="pharmacyschool.usc.edu" />
	<target host="pharmgradprograms.usc.edu" />
	<target host="policy.usc.edu" />
	<target host="preparedness.usc.edu" />
	<target host="pressroom.usc.edu" />
	<target host="procurement.usc.edu" />

	<target host="help.provost.usc.edu" />
	<target host="it.provost.usc.edu" />
	<target host="mypassword.provost.usc.edu" />
	<target host="www.provost.usc.edu" />

	<target host="regulatory.usc.edu" />
	<!--target host="roski.usc.edu" /-->
	<target host="rossier.usc.edu" />
	<target host="rossiercareers.usc.edu" />
	<target host="rossierfaculty.usc.edu" />
	<target host="rossierstudents.usc.edu" />
	<target host="safety.usc.edu" />
	<target host="sait.usc.edu" />
	<target host="sarc.usc.edu" />
	<target host="scacommunity.usc.edu" />
	<target host="scampus.usc.edu" />
	<target host="shibboleth.usc.edu" />
	<target host="strategic.usc.edu" />
	<target host="stuaff.usc.edu" />
	<target host="studenaffairs.usc.edu" />
	<target host="studentblackboardhelp.usc.edu" />
	<target host="talent.usc.edu" />
	<target host="trojansalert.usc.edu" />
	<target host="trojantime.usc.edu" />
	<target host="test10.usc.edu" />
	<target host="uscnow.usc.edu" />
	<target host="undergrad.usc.edu" />
	<target host="undergradpreview.usc.edu" />
	<target host="vsoeapp1.vsoe.usc.edu" />
	<target host="web-app.usc.edu" />
	<target host="webreg.vsoe.usc.edu" />
	<target host="www.usc.edu" />

	<!--	Complications:
				-->
	<target host="usc.edu" />
	<target host="www.dornsife.usc.edu" />
	<target host="service.marshall.usc.edu" />
	<target host="policies.usc.edu" />


	<securecookie host="." name="." />


	<rule from="^http://usc\.edu/"
		to="https://www.usc.edu/" />

	<rule from="^http://www\.dornsife\.usc\.edu/"
		to="https://dornsife.usc.edu/" />

	<!--	Redirect drops path, args, and forward slash:
								-->
	<rule from="^http://service\.marshall\.usc\.edu/.*"
		to="https://uscmarshall.service-now.com/" />

		<test url="http://service.marshall.usc.edu//index.aspx" />

	<rule from="^http://mypassword\.provost\.usc\.edu:9251/"
		to="https://mypassword.provost.usc.edu:9251/" />

		<test url="http://mypassword.provost.usc.edu:9251/" />

	<rule from="^http://policies\.usc\.edu/"
		to="https://policy.usc.edu/" />

	<rule from="^http:"
		to="https:" />

</ruleset>
