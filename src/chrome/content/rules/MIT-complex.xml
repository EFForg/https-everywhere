<!--
	For simple rules, see MIT.xml.

	As of July 2018, the site requests a client cert over HTTPS:
	https://github.com/EFForg/https-everywhere/pull/14417#issuecomment-408202131
-->

<ruleset name="MIT.edu (complex)" default_off="breaks-site">
	<target host="mit.edu" />
	<target host="www.mit.edu" />
	<target host="web.mit.edu" />

	<!-- https://github.com/EFForg/https-everywhere/issues/14397
		Should not get secured:
			- http://mit.edu/~puzzle/
			- http://www.mit.edu/~puzzle/
			- http://web.mit.edu/puzzle/www/
	-->
	<rule from="^http://(www\.|web\.)?mit\.edu/($|files/)" to="https://web.mit.edu/$2" />

		<!-- Should get secured: -->
		<test url="http://mit.edu/files/assets/images/favicon.ico" />
		<test url="http://www.mit.edu/files/assets/images/favicon.ico" />
		<test url="http://web.mit.edu/files/assets/images/favicon.ico" />
</ruleset>
