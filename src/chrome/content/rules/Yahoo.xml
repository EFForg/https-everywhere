<!--
	Other Yahoo rulesets:

		- Flickr.xml
		- Right-Media.xml
		- Yahoo_APIs.xml
		- Yahoo_Japan.xml
		- Yimg.com.xml
		- YUI_Library.xml


	CDN buckets:

		- contextualads.yahoo.net.edgesuite.net

			- a1907.g.akamai.net

		- yahoosports.teamfanshop.com


	Nonfunctional domains:

		- yahoo.com subdomains:

			- advertising ¹
			- advertisingcentral ¹
			- answers ²
			- fr.answers ³
			- malaysia.answers ³
			- au ¹
			- autos ¹
			- br ²
			- ca ²
			- cn ¹
			- help.cn ¹
			- news.cn ¹
			- de ²
			- docs ¹
			- fr.docs ¹
			- en-maktoob ⁴
			- es ²
			- eurosport ³
			- uk.eurosport ³
			- everything ³
			- fantasysports ¹

			- finance subdomains:

				- ^ ²
				- chart ¹
				- ichart ¹
				- streamerapi ¹

			- fr ²
			- health ¹
			- hk ³
			- hsrd ¹
			- ichart ¹
			- id ²
			- ie ²
			- in ²
			- it ²
			- kr ¹
			- labs ¹
			- tw.ipeen.lifestyle ¹
			- tw.lifestyle ¹
			- local ³
			- maktoob ⁴
			- maps ³
			- gws2.maps ¹
			- mx ²

			- news subdomains:

				- cn ¹
				- dk ¹
				- ie ¹
				- kr ¹

			- opi ¹
			- ph ²
			- qc ²
			- ar.rd ¹
			- research ¹
			- rightmedia			(shows speakers.watersmartinnovations.com; mismatched, CN: *.watersmartinnovations.com)
			- tools.search ⁵
			- gossip-ss.us.search ¹
			- sg ²
			- shopping ³
			- sports ²
			- suggestions ¹
			- tw ¹
			- uk ²
			- vn ²
			- voices ²
			- cn.weather ¹
			- visit.webhosting ⁵
			- count.yisou ¹
			- dmros.ysm			(400, valid cert)

		- yahoo.net subdomains:

			- health		(504, akamai)
			- uk.match ⁵
			- uk.matchaffinity ⁵

		- ypolicyblog.com		(reset)
		- www.ypolicyblog.com

	¹ Refused
	² Redirects to http, valid cert
	³ 404, valid cert
	⁴ Redirects to http; mismatched, CN: www.yahoo.com
	⁵ Dropped


	Problematic domains:

		- i.acdn.us ¹
		- cm.npc-morris.overture.com ²
		- cm.npc-nydn.overture.com ²
		- totaltravel.co.uk ³
		- www.totaltravel.co.uk ⁴
		- totaltravel.com ³
		- www.totaltravel.com ⁴

		yahoo.com subdomains:

			- fr-ca.actualites ⁵
			- ar		(mixed css from l.yimg.com)
			- id.berita ⁵
			- mx.clima ⁵
			- dk ⁴
			- feedback ⁴
			- help		(valid cert, 404)
			- info		(mixed css from l.yimg.com)

			- lifestyle subdomains:

				- ar ⁴
				- br ⁴
				- ca ⁴
				- es ⁴
				- fr ⁴
				- ie ⁴
				- it ⁴

			- external.global.media ⁵
			- fr.meteo ⁵
			- it.meteo ⁵
			- webservices.mobile	(works, self-signed)
			- br.mulher ⁵
			- de.nachrichten ⁵

			- news subdomains:

				- ar ⁴
				- br ⁴
				- de ⁴
				- id ⁴
				- it ⁴
				- mx ⁴
				- qc ⁴

			- notepad	(works; mismatched, CN: *.calendar.yahoo.com)
			- it.notizie ⁵
			- fr.pourelles ⁵
			- ru ⁴
			- es.tendencias ⁵
			- br.tempo ⁵
			- ar.tiempo ⁵
			- es.tiempo ⁵

			- weather subdomains:

				- ar ⁴
				- au ⁴
				- br ⁴
				- de ⁴
				- es ⁴
				- fr ⁴
				- kr ⁴
				- tw ⁴
				- mx ⁴

			- de.wetter ⁵

		- contextualads.yahoo.net	(works, akamai)
		- investor.yahoo.net ¹
		- (www.)yhoo.it		(refused, bit.ly alias)

	¹ Dropped
	² Works, mismatched, CN: *.ysm.yahoo.com
	³ Works; mismatched, CN: builder.totaltravel.com
	⁴ Refused
	⁵ Works; mismatched, CN: *.news.yahoo.com


	Partially covered domains:

		- (www.)totaltravel.com		(→ au.totaltravel.yahoo.com, haven't found images/)
		- developer.yahoo.com		(homepage redirects to http)
		- ca.sports.yahoo.com		($ redirects to ^sports.yahoo.com)
		- contextualads.yahoo.net	(→ akamai, avoiding user-visible paths)
		- investor.yahoo.net		(→ investor.shareholder.com)
		- uk.health.lifestyle.yahoo.net	(→ s.yimg.com)


	Fully covered domains:

		- i.acdn.us			(→ s.yimg.com/ck/)

		- (www.)totaltravel.co.uk	(→ au.totaltravel.yahoo.com)

		- yahoo.com subdomains:

			- (www.)

			- \w\w.adserver:

				- au
				- uk
				- us

			- beap.adx
			- c5.ah
			- c5a.ah
			- cookex.amp
			- s-cookex.amp
			- [aoyz].analytics
			- y3.analytics
			- global.ard

			- bc subdomains:

				- clicks.beap
				- csc.beap
				- pn1
				- row
				- us

			- boss
			- celebrity
			- migration.cn
			- br.contribuidores
			- contributor
			- uk.contributor
			- dk			(→ www)
			- edit
			- na.edit
			- edit.europe
			- java.europe		(→ adgallery.zenfs.com)
			- feedback		(→ yahoo.uservoice.com)
			- geo
			- groups
			- moderators.groups
			- help
			- secure.help
			- homes
			- legalredirect

			- lifestyle subdomains:

				- ar	(→ ar.mujer)
				- au
				- ca	(→ ca.shine)
				- de
				- hk
				- ie	(→ uk.lifestyle)
				- in
				- it
				- mx	(→ mx.mujer)
				- uk

			- login
			- us.lrd
			- gh.bouncer.login
			- m
			- r.m

			- \w\w.m:

				- ar
				- au
				- br
				- ca
				- cn
				- de
				- es
				- fr
				- hk
				- id
				- ie
				- in
				- it
				- kr
				- ph
				- qc
				- sg
				- mx
				- tw
				- uk
				- us
				- vn

			- mail

			- *.mail:

				- overview
				- us-mg6
				- c.c.yom
				- \w+-c.c.yom

			- mlogin
			- mobile
			- movies
			- ar.mujer
			- mx.mujer
			- music

			- *.msg:

				- dps			(→ ycpi-mail-dps)
				- prod2.rest-core
				- prod1.rest-notify
				- ycpi-mail-dps
				- ycpi-mail-preferences
				- ycpi-mail-rest-core
				- ycpi-mail-rest-core2

			- my
			- ucs.netsvs

			- news subdomains:

				- ^
				- ar	(→ ar.noticias)
				- br	(→ br.noticias)
				- au
				- ca
				- es	(→ es.noticias)
				- fr
				- hk
				- in
				- mx	(→ mx.noticias)
				- ph
				- sg
				- tw
				- uk
				- vn

			- cookiex.ngd

			- noticias subdomains:

				- ar
				- br
				- es
				- mx

			- omg
			- rtb.pclick

			- query subdomains:

				- analytics
				- mailapps
				- media
				- ucs
				- us-locdrop
				- video

			- us.rd
			- ru		(→ www)
			- screen
			- search
			- images.search
			- rtb.pclick.secure
			- shine
			- order.smallbusiness
			- data.toolbar
			- au.totaltravel
			- travel
			- tv
			- us
			- qos.video
			- yep.video

			- weather subdomains:

				^
				- ca
				- hk
				- in
				- ph
				- sg
				- tw	(→ tw.news)
				- uk
				- us

		- yahoo.net subdomains:

			- image-c.c.yom.mail
			- lib.store
			- order.store


	Mixed content:

		- css on ar.yahoo.com, info.yahoo.com, and ca.sports.yahoo.com from l.yimg.com *

		- Ads/web bugs, on:

			- ar.yahoo.com from b.scorecardresearch.com *
			- ar.yahoo.com, m.yahoo.com, \w\w.m.yahoo.com, and ar.mujer.yahoo.com from csc.beap.bc.yahoo.com *
			- games.yahoo.com and music.yahoo.com from rtb.pclick.yahoo.com *
			- au.news.yahoo.com from au.adserver.yahoo.com *
			- shine.yahoo.com from www.facebook.com *

		- Images, on:

			- ar.yahoo.com, games.yahoo.com, info.yahoo.com, m.yahoo.com, us.m.yahoo.com, au.news.yahoo.com, screen.yahoo.com, and ca.sports.yahoo.com from l.yimg.com *
			- \w\w.weather.yahoo.com from media.zenfs.com *

	* Secured by us


	Reported to fix bug

		https://trac.torproject.org/projects/tor/ticket/4441


	If you have a Yahoo Mail account, please test this ruleset!

-->
<ruleset name="Yahoo! (partial)">

	<target host="i.acdn.us" />
	<target host="rocketmail.com" />
	<target host="www.rocketmail.com" />
	<target host="totaltravel.co.uk" />
	<target host="www.totaltravel.co.uk" />
	<target host="totaltravel.com" />
	<target host="*.totaltravel.com" />
		<exclusion pattern="^http://(?:www\.)?totaltravel\.com/images/" />
	<target host="yahoo.com" />
	<target host="*.yahoo.com" />
		<exclusion pattern="^http://developer\.yahoo\.com/(?:$|\?)" />
		<!--
			Refused:
					-->
		<!--exclusion pattern="^http://(cn|de|dk|id|ie|it|qc)\.news\.yahoo\.com/" /-->
		<!--
			- $ redirects to ^sports
			- top/ has mixed css from l.yimg.com
								-->
		<exclusion pattern="^http://ca\.sports\.yahoo\.com/+(?!featured/)" />
	<target host="*.yahoo.net" />
		<!--
			Avoid user-visible paths:
							-->
		<!--exclusion pattern="^http://contextualads\.yahoo\.net/(?!js/|style/)" /-->
		<!--
			Links images relative to /
							-->
		<!--exclusion pattern="^http://contextualads\.yahoo\.net/style/screen\.css" /-->
		<!--
			Some pages redirect to http:
							-->
		<exclusion pattern="^http://smallbusiness\.yahoo\.com/(?!servicecheck\.php)" />
	<target host="*.yahoofs.com" />
	<target host="yhoo.it" />
	<target host="ymail.com" />
	<target host="www.ymail.com" />
	<target host="*.zenfs.com" />


	<!--	Some Yahoo cookies are cross-domain cookies.
		It's a case of figuring out which ones
		aren't needed on unsecurable pages.

			- .yahoo.com
				- AO
				- B
					- Set by y3.analytics.yahoo.com/itr.pl & us.bc.yahoo.com/b

				- BA

					- t=\d{10}

				- CH
					- \w{59}/
				- F

				- HP

					- 0

				- MSC
					- t=\d{10}X
				- PH	(set by hjsal)
				- SSL

				- ucs	(set by ucs.query)

					- bnas=\d

				- V

					- v=\d.\d&cc=0&m=0

				- Y

			- .news.yahoo.com

				- ywadp\d+

					- \d+

			- .uk.yahoo.com

				- epc

					- 1

				- fpc

					- d=(\w+.){7}\w+- -&v=1

				- FPCK

					- \w{50}

				- fpc_s

					- d=(\w+.){7}\w+- -&v=1

				- fpt

					- d=(\w+.){7}\w+- -&v=1

				- fpps

					- _page=%7B%22wsid%22%3A%22\d{10}%22%7D

			- .us.yahoo.com

				- fpc

					- d=(\w+.){4}\w+-&v=2

				- fpms

					- p_\d{8}=%7B%22stream_filter%22%3A%22%3A%3A\d{13}%22%7D

				- fpt

					- d=\w+.\w+.\w+&v=1

		Others observed:

			- .search.yahoo.com
				- sSN
					-  \w{63}\.\w{22}\-{2}

		-->
	<securecookie host="^\.yahoo\.com$" name="^(?:AO|B|SSL)$" />
	<securecookie host="^(?:\.analytics|\.mail|movies|news|(?:us-locdrop|video)\.query|images\.search|us|\.www)\.yahoo\.com$" name=".+" />
	<securecookie host=".+-c\.c\.yom\.mail\.yahoo\.net$" name=".+" />
	<securecookie host="^\.zenfs\.com$" name="^BX$" />


	<rule from="^http://i\.acdn\.us/"
		to="https://s.yimg.com/ck/" />

	<rule from="^http://(?:www\.)?(?:rocket|y)mail\.com/"
		to="https://mail.yahoo.com/" />

	<rule from="^http://(?:www\.)?totaltravel\.co(?:m|\.uk)/"
		to="https://au.totaltravel.yahoo.com/" />

	<rule from="^http://builder\.totaltravel\.com/"
		to="https://builder.totaltravel.com/" />

	<!--	This rule must be above the main one:
							-->
	<rule from="^http://dps\.msg\.yahoo\.com/"
		to="https://ycpi-mail-dps.msg.yahoo.com/" />

	<rule from="^http://((?:\w\w\.adserver|beap\.adx|c5a?\.ah|y\.analytics|(?:s-)?cookex\.amp|(?:[aosz]|y3)\.analytics|global\.ard|(?:clicks\.beap|csc\.beap|pn1|row|us)\.bc|boss|calendar|celebrity|migration\.cn|br\.contribuidores|(?:uk\.)?contributor|developer|(?:na\.)?edit|edit\.europe|geo|groups|moderators\.groups|help|secure\.help|homes|legalredirect|(?:au|de|hk|in|it|uk)\.lifestyle|(?:gh\.bouncer\.)?login|us\.l?rd|m|r\.m|\w\w\.m|(?:[\w-]+\.)?mail|mlogin|mobile|movies|[\w.-]+\.msg|music|my|ucs\.netsvs|news|(?:au|ca|fr|hk|in|ph|sg|tw|uk)\.news|cookiex\.ngd|omg|rtb\.pclick|(?:analytics|mailapps|media|ucs|us-locdrop|video)\.query|screen|search|images\.search|sec|rtb\.pclick\.secure|shine|(?:order\.)?smallbusiness|ca\.sports|data\.toolbar|au\.totaltravel|travel|tv|us|(?:qos|yep)\.video|weather|(?:ca|hk|in|sg|ph|uk|us)\.weather|www)\.)?yahoo\.com/"
		to="https://$1yahoo.com/" />

	<rule from="^http://(?:dk|ru)\.yahoo\.com/"
		to="https://www.yahoo.com/" />

	<rule from="^http://java\.europe\.yahoo\.com/"
		to="https://adgallery.zenfs.com/" />

	<rule from="^http://feedback\.yahoo\.com/"
		to="https://yahoo.uservoice.com/" />

	<rule from="^http://([\w-]+)\.c\.yom\.mail\.yahoo\.(com|net)/"
		to="https://$1.c.yom.mail.yahoo.$2/" />

	<rule from="^http://(ar|mx)\.(?:lifestyle|mujer)\.yahoo\.com/"
		to="https://$1.mujer.yahoo.com/" />

	<rule from="^http://ca\.(?:lifestyle|shine)\.yahoo\.com/"
		to="https://ca.shine.yahoo.com/" />

	<!--	Server drops path and args:
						-->
	<rule from="^http://ie\.lifestyle\.yahoo\.com/.*"
		to="https://uk.lifestyle.yahoo.com/" />

	<rule from="^http://(ar|br|es|mx)\.n(?:ew|oticia)s\.yahoo\.com/"
		to="https://$1.news.yahoo.com/" />

	<!--	Cert only matches us.rd,
		all appear equivalent.
					-->
	<rule from="^http://rds?\.yahoo\.com/"
		to="https://us.rd.yahoo.com/" />

	<!--	Server drops path and args:
						-->
	<rule from="^http://tw\.weather\.yahoo\.com/.*"
		to="https://tw.news.yahoo.com/weather-forecast/" />

	<rule from="^http://contextualads\.yahoo\.net/(?=js/|style/(?!screen\.css))"
		to="https://a248.e.akamai.net/f/1907/9547/9m/contextualads.yahoo.net/" />

	<rule from="^http://uk\.health\.lifestyle\.yahoo\.net/images/"
		to="https://s.yimg.com/lq/lib/lsl/i/uk/" />

	<rule from="^http://investor\.yahoo\.net/common/"
		to="https://investor.shareholder.com/common/" />

	<rule from="^http://(lib|order)\.store\.yahoo\.net/"
		to="https://$1.store.yahoo.net/" />

	<rule from="^http://([\w-]+)\.yahoofs\.com/"
		to="https://$1.yahoofs.com/" />

	<rule from="^http://yhoo\.it/"
		to="https://bit.ly/" />

	<rule from="^http://(\w+)\.zenfs\.com/"
		to="https://$1.zenfs.com/" />

</ruleset>
