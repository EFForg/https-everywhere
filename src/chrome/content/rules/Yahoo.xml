<!--
	Other Yahoo rulesets:

		- Flickr.xml
		- Right-Media.xml
		- Yahoo_APIs.xml
		- Yahoo_Japan.xml
		- Yimg.com.xml
		- YUI_Library.xml


	CDN buckets:

		- contextualads.yahoo.net.edgesuite.net

			- a1907.g.akamai.net

		- yahoosports.teamfanshop.com


	Nonfunctional domains:

		- yahoo.com subdomains:

			- advertising ²
			- advertisingcentral ³
			- answers ²
			- fr.answers ²
			- malaysia.answers ²
			- autos ³
			- br ¹
			- ca ¹
			- cn ³
			- help.cn ³
			- de ¹
			- docs ³
			- fr.docs ³
			- en-maktoob ⁴
			- eurosport ²
			- uk.eurosport ²
			- everything ²

			- finance subdomains:

				- ^ ¹
				- chart ³
				- ichart ³
				- streamerapi ³

			- fr ¹
			- games ²
			- groups ¹
			- moderators.groups		(works; expired 2013-12-19, mismatched, CN: groups.yahoo.com)
			- health ³
			- homes ²
			- hsrd ³
			- ichart ³
			- ie ¹
			- in ¹
			- info ²
			- kr ³
			- labs ³
			- local ²
			- maktoob ⁴
			- maps ²
			- gws2.maps ³
			- external.global.media ⁵
			- fr.meteo ⁵
			- mobile			(404; mismatched, CN: *.manhattan.yahoo.com)
			- music ²
			- my ²
			- opi ³
			- ar.rd ³
			- research ³
			- rightmedia			(shows speakers.watersmartinnovations.com; mismatched, CN: *.watersmartinnovations.com)
			- tools.search ⁶
			- gossip-ss.us.search ³
			- shopping ²
			- sports ¹
			- suggestions ³
			- travel ²
			- tv ²
			- uk ¹
			- voices ¹
			- fr.weather ³
			- visit.webhosting ⁶
			- count.yisou ³
			- dmros.ysm			(400, valid cert)

		- yahoo.net subdomains:

			- health		(504, akamai)
			- uk.match ⁶
			- uk.matchaffinity ⁶

		- ypolicyblog.com		(reset)
		- www.ypolicyblog.com

	¹ Redirects to http, valid cert
	² 404, valid cert
	³ Refused
	⁴ Redirects to http; mismatched, CN: www.yahoo.com
	⁵ 404; mismatched, CN: *.news.yahoo.com)
	⁶ Dropped


	Problematic domains:

		- i.acdn.us ¹
		- cm.npc-morris.overture.com ²
		- cm.npc-nydn.overture.com ²
		- totaltravel.co.uk ³
		- www.totaltravel.co.uk ⁴
		- totaltravel.com ³
		- www.totaltravel.com ⁴

		yahoo.com subdomains:

			- feedback ⁴
			- help		(valid cert; 404)
			- m ⁵
			- us.m ⁵
			- webservices.mobile	(works, self-signed)
			- notepad	(works; mismatched, CN: *.calendar.yahoo.com)

		- contextualads.yahoo.net	(works, akamai)
		- investor.yahoo.net ¹
		- (www.)yhoo.it		(refused, bit.ly alias)

	¹ Dropped
	² Works, mismatched, CN: *.ysm.yahoo.com
	³ Works; mismatched, CN: builder.totaltravel.com
	⁴ Refused
	⁵ Works, but some resources don't


	Partially covered domains:

		- (www.)totaltravel.com		(→ au.totaltravel.yahoo.com, haven't found images/)
		- developer.yahoo.com		(homepage redirects to http)
		- contextualads.yahoo.net	(→ akamai, avoiding user-visible paths)
		- investor.yahoo.net		(→ investor.shareholder.com)
		- uk.health.lifestyle.yahoo.net	(→ s.yimg.com)


	Fully covered domains:

		- i.acdn.us			(→ s.yimg.com/ck/)

		- (www.)totaltravel.co.uk	(→ au.totaltravel.yahoo.com)

		- yahoo.com subdomains:

			- (www.)
			- uk.adserver
			- us.adserver
			- beap.adx
			- c5.ah
			- c5a.ah
			- cookex.amp
			- s-cookex.amp
			- [aoyz].analytics
			- y3.analytics
			- global.ard

			- bc subdomains:

				- clicks.beap
				- csc.beap
				- pn1
				- row
				- us

			- boss
			- migration.cn
			- br.contribuidores
			- contributor
			- uk.contributor
			- edit
			- na.edit
			- edit.europe
			- java.europe		(→ adgallery.zenfs.com)
			- feedback		(→ yahoo.uservoice.com)
			- geo
			- help
			- secure.help
			- legalredirect
			- login
			- us.lrd
			- gh.bouncer.login
			- r.m
			- mail

			- *.mail:

				- overview
				- us-mg6
				- c.c.yom
				- \w+-c.c.yom

			- mlogin
			- movies

			- *.msg:

				- dps			(→ ycpi-mail-dps)
				- prod2.rest-core
				- prod1.rest-notify
				- ycpi-mail-dps
				- ycpi-mail-preferences
				- ycpi-mail-rest-core
				- ycpi-mail-rest-core2

			- ucs.netsvs

			- news
			- ca.news
			- uk.news
			- cookiex.ngd
			- omg
			- rtb.pclick

			- query subdomains:

				- analytics
				- mailapps
				- media
				- ucs
				- us-locdrop
				- video

			- us.rd
			- screen
			- search
			- images.search
			- rtb.pclick.secure
			- shine
			- order.smallbusiness
			- data.toolbar
			- au.totaltravel
			- us
			- qos.video
			- yep.video
			- weather
			- ca.weather
			- uk.weather
			- us.weather

		- yahoo.net subdomains:

			- image-c.c.yom.mail
			- lib.store
			- order.store


	Mixed content:

		- Ads/web bugs, on:

			- m.yahoo.com and ca.news.yahoo.com from csc.beap.bc.yahoo.com *
			- ca.news.yahoo.com from ad.yieldmanager.com *
			- shine.yahoo.com from www.facebook.com *
			- weather.yahoo.com from ads.yimg.com *

		- Images, on:

			- m.yahoo.com, us.m.yahoo.com, and screen.yahoo.com from l.yimg.com *

	* Secured by us


	Reported to fix bug

		https://trac.torproject.org/projects/tor/ticket/4441


	If you have a Yahoo Mail account, please test this ruleset!

-->
<ruleset name="Yahoo! (partial)">

	<target host="i.acdn.us" />
	<target host="rocketmail.com" />
	<target host="www.rocketmail.com" />
	<target host="totaltravel.com" />
	<target host="*.totaltravel.com" />
		<exclusion pattern="^https?://(?:www\.)?totaltravel\.com/images/" />
	<target host="totaltravel.co.uk" />
	<target host="www.totaltravel.co.uk" />
	<target host="yahoo.com" />
	<target host="*.yahoo.com" />
		<exclusion pattern="^https?://developer\.yahoo\.com/(?:$|\?)" />
	<target host="*.yahoo.net" />
		<!--
			Avoid user-visible paths:
							-->
		<exclusion pattern="^http://contextualads\.yahoo\.net/(?!js/|style/)" />
		<!--
			Links images relative to /
							-->
		<exclusion pattern="^http://contextualads\.yahoo\.net/style/screen\.css" />
	<target host="*.yahoofs.com" />
	<target host="yhoo.it" />
	<target host="ymail.com" />
	<target host="www.ymail.com" />
	<target host="*.zenfs.com" />


	<!--	Some Yahoo cookies are cross-domain cookies.
		It's a case of figuring out which ones
		aren't needed on unsecurable pages.

			- .yahoo.com
				- AO
				- B
					- Set by y3.analytics.yahoo.com/itr.pl & us.bc.yahoo.com/b

				- BA

					- t=\d{10}

				- CH
					- \w{59}/
				- F

				- HP

					- 0

				- MSC
					- t=\d{10}X
				- PH	(set by hjsal)
				- SSL

				- ucs	(set by ucs.query)

					- bnas=\d

				- V

					- v=\d.\d&cc=0&m=0

				- Y

			- .news.yahoo.com

				- ywadp\d+

					- \d+

			- .uk.yahoo.com

				- epc

					- 1

				- fpc

					- d=(\w+.){7}\w+- -&v=1

				- FPCK

					- \w{50}

				- fpc_s

					- d=(\w+.){7}\w+- -&v=1

				- fpt

					- d=(\w+.){7}\w+- -&v=1

				- fpps

					- _page=%7B%22wsid%22%3A%22\d{10}%22%7D

			- .us.yahoo.com

				- fpc

					- d=(\w+.){4}\w+-&v=2

				- fpms

					- p_\d{8}=%7B%22stream_filter%22%3A%22%3A%3A\d{13}%22%7D

				- fpt

					- d=\w+.\w+.\w+&v=1

			- .s.yimg.com
				- XCNM

		Others observed:

			- .search.yahoo.com
				- sSN
					-  \w{63}\.\w{22}\-{2}

		-->
	<securecookie host="^\.yahoo\.com$" name="^(?:AO|B|SSL)$" />
	<securecookie host="^\.(?:analytics|mail)\.yahoo\.com$" name=".+" />
	<securecookie host="^(?:movies|news|(?:us-locdrop|video)\.query|images\.search|us|\.www)\.yahoo\.com$" name=".+" />
	<securecookie host="^.+-c\.c\.yom\.mail\.yahoo\.net$" name=".+" />
	<securecookie host="^\.zenfs\.com$" name="^BX$" />


	<rule from="^http://i\.acdn\.us/"
		to="https://s.yimg.com/ck/" />

	<rule from="^http://(?:www\.)?totaltravel\.co(?:m|\.uk)/"
		to="https://au.totaltravel.yahoo.com/" />

	<rule from="^http://builder\.totaltravel\.com/"
		to="https://builder.totaltravel.com/" />

	<rule from="^http://(?:www\.)?(?:rocket|y)mail\.com/"
		to="https://mail.yahoo.com/" />

	<rule from="^http://java\.europe\.yahoo\.com/"
		to="https://adgallery.zenfs.com/" />

	<rule from="^http://dps\.msg\.yahoo\.com/"
		to="https://ycpi-mail-dps.msg.yahoo.com/" />

	<rule from="^http://((?:u[ks]\.adserver|beap\.adx|c5a?\.ah|y\.analytics|calendar|(?:s-)?cookex\.amp|(?:[aosz]|y3)\.analytics|global\.ard|(?:clicks\.beap|csc\.beap|pn1|row|us)\.bc|migration\.cn|br\.contribuidores|boss|(?:uk\.)?contributor|developer|(?:na\.)?edit|edit\.europe|geo|legalredirect|(?:gh\.bouncer\.)?login|us\.l?rd|r\.m|(?:[\w-]+\.)?mail|mlogin|movies|[\w\.-]+\.msg|ucs\.netsvs|(?:ca|uk)\.news|cookiex\.ngd|omg|rtb\.pclick|(?:analytics|mailapps|media|ucs|us-locdrop|video)\.query|screen|search|images\.search|sec|rtb\.pclick\.secure|shine|order\.smallbusiness|data\.toolbar|au\.totaltravel|us|(?:qos|yep)\.video|weather|(?:ca|uk|us)\.weather|www)\.)?yahoo\.com/"
		to="https://$1yahoo.com/" />

	<rule from="^http://feedback\.yahoo\.com/"
		to="https://yahoo.uservoice.com/" />

	<rule from="^http://uk\.health\.lifestyle\.yahoo\.net/images/"
		to="https://s.yimg.com/lq/lib/lsl/i/uk/" />

	<rule from="^http://(?:secure\.)?help\.yahoo\.com/"
		to="https://secure.help.yahoo.com/" />

	<rule from="^http://([\w-]+)\.c\.yom\.mail\.yahoo\.(com|net)/"
		to="https://$1.c.yom.mail.yahoo.$2/" />

	<!--	Cert only matches us.rd,
		all appear equivalent.
					-->
	<rule from="^http://rds?\.yahoo\.com/"
		to="https://us.rd.yahoo.com/" />

	<rule from="^http://smallbusiness\.yahoo\.com/servicecheck\.php"
		to="https://smallbusiness.yahoo.com/servicecheck.php" />

	<rule from="^http://contextualads\.yahoo\.net/"
		to="https://a248.e.akamai.net/f/1907/9547/9m/contextualads.yahoo.net/" />

	<rule from="^http://investor\.yahoo\.net/common/"
		to="https://investor.shareholder.com/common/" />

	<rule from="^http://(lib|order)\.store\.yahoo\.net/"
		to="https://$1.store.yahoo.net/" />

	<rule from="^http://([\w-]+)\.yahoofs\.com/"
		to="https://$1.yahoofs.com/" />

	<rule from="^http://yhoo\.it/"
		to="https://bit.ly/" />

	<rule from="^http://(\w+)\.zenfs\.com/"
		to="https://$1.zenfs.com/" />

	<rule from="^http://news\.yahoo\.com/"
		to="https://news.yahoo.com/" />

</ruleset>
